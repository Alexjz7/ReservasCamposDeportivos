óü
vC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Controllers\AccessController.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $
Controllers$ /
{ 
public 

class 
AccessController !
:" #

Controller$ .
{ 
private 
readonly 
AppDbContext %
_context& .
;. /
public 
AccessController 
(  
AppDbContext  ,
context- 4
)4 5
{ 	
_context 
= 
context 
; 
} 	
[ 	
HttpGet	 
] 
public 
IActionResult 
Login "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
HttpPost	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
Login) .
(. /
Usuarios/ 7
user8 <
)< =
{   	
if!! 
(!! 
user!! 
.!! 
usuario!! 
!=!! 
null!!  $
&&!!% '
user!!( ,
.!!, -
pass!!- 1
!=!!2 4
null!!5 9
)!!9 :
{"" 
var$$ 
_user$$ 
=$$ 
validarCredenciales$$ /
($$/ 0
user$$0 4
.$$4 5
usuario$$5 <
,$$< =
user$$> B
.$$B C
pass$$C G
)$$G H
;$$H I
if&& 
(&& 
_user&& 
!=&& 
null&& !
)&&! "
{'' 
var(( 
claims(( 
=((  
new((! $
List((% )
<(() *
Claim((* /
>((/ 0
{)) 
new** 
Claim** 
(** 

ClaimTypes** (
.**( )
NameIdentifier**) 7
,**7 8
_user**9 >
.**> ?

id_usuario**? I
.**I J
ToString**J R
(**R S
)**S T
)**T U
,**U V
new++ 
Claim++ 
(++ 

ClaimTypes++ (
.++( )
Name++) -
,++- .
_user++/ 4
.++4 5
nombres++5 <
+++< =
$str++> A
+++B C
_user++D I
.++I J
	apellidos++J S
)++S T
,++T U
new,, 
Claim,, 
(,, 

ClaimTypes,, (
.,,( )
Email,,) .
,,,. /
_user,,0 5
.,,5 6
correo,,6 <
),,< =
,,,= >
new-- 
Claim-- 
(-- 

ClaimTypes-- (
.--( )
	GivenName--) 2
,--2 3
_user--4 9
.--9 :
usuario--: A
)--A B
,--B C
new.. 
Claim.. 
(.. 

ClaimTypes.. (
...( )
MobilePhone..) 4
,..4 5
_user..6 ;
...; <
celular..< C
)..C D
,..D E
new// 
Claim// 
(// 

ClaimTypes// (
.//( )
	GivenName//) 2
,//2 3
_user//4 9
.//9 :
tipoDocumento//: G
)//G H
,//H I
new00 
Claim00 
(00 

ClaimTypes00 (
.00( )
SerialNumber00) 5
,005 6
_user007 <
.00< =
	documento00= F
)00F G
,00G H
new11 
Claim11 
(11 

ClaimTypes11 (
.11( )
Role11) -
,11- .
_user11/ 4
.114 5
Rol115 8
.118 9
Descripcion119 D
)11D E
}22 
;22 
var44 
claimsIdentity44 &
=44' (
new44) ,
ClaimsIdentity44- ;
(44; <
claims44< B
,44B C(
CookieAuthenticationDefaults55< X
.55X Y 
AuthenticationScheme55Y m
)55m n
;55n o
await66 
HttpContext66 %
.66% &
SignInAsync66& 1
(661 2(
CookieAuthenticationDefaults662 N
.66N O 
AuthenticationScheme66O c
,66c d
new774 7
ClaimsPrincipal778 G
(77G H
claimsIdentity77H V
)77V W
)77W X
;77X Y
return88 
RedirectToAction88 +
(88+ ,
$str88, B
,88B C
$str88D J
)88J K
;88K L
}99 
ViewData:: 
[:: 
$str:: "
]::" #
=::$ %
$str::& U
;::U V
};; 
return<< 
View<< 
(<< 
)<< 
;<< 
}== 	
public?? 
async?? 
Task?? 
<?? 
IActionResult?? '
>??' (
Logout??) /
(??/ 0
)??0 1
{@@ 	
awaitAA 
HttpContextAA 
.AA 
SignOutAsyncAA *
(AA* +(
CookieAuthenticationDefaultsAA+ G
.AAG H 
AuthenticationSchemeAAH \
)AA\ ]
;AA] ^
returnBB 
RedirectToActionBB #
(BB# $
$strBB$ +
,BB+ ,
$strBB- 5
)BB5 6
;BB6 7
}CC 	
[EE 	
HttpGetEE	 
]EE 
publicFF 
IActionResultFF 
	RegistrarFF &
(FF& '
)FF' (
{GG 	
returnHH 
ViewHH 
(HH 
)HH 
;HH 
}II 	
[KK 	
HttpPostKK	 
]KK 
publicLL 
ActionResultLL 
	RegistrarLL %
(LL% &
UsuariosLL& .
userLL/ 3
)LL3 4
{MM 	
ifNN 
(NN 
userNN 
.NN 
passNN 
!=NN 
nullNN !
)NN! "
{OO 
userPP 
.PP 
passPP 
=PP 
	EncriptarPP %
(PP% &
userPP& *
.PP* +
passPP+ /
)PP/ 0
;PP0 1
userQQ 
.QQ 
id_rolQQ 
=QQ 
$numQQ 
;QQ  
userRR 
.RR 
estadoRR 
=RR 
trueRR "
;RR" #
ifSS 
(SS 

ModelStateSS 
.SS 
IsValidSS &
)SS& '
{TT 
ifVV 
(VV 
_contextVV  
.VV  !
UsuariosVV! )
.VV) *
AnyVV* -
(VV- .
uVV. /
=>VV0 2
uWW 
.WW 
usuarioWW !
==WW" $
userWW% )
.WW) *
usuarioWW* 1
||WW2 4
uXX 
.XX 
correoXX  
==XX! #
userXX$ (
.XX( )
correoXX) /
||XX0 2
uYY 
.YY 
	documentoYY #
==YY$ &
userYY' +
.YY+ ,
	documentoYY, 5
||YY6 8
uZZ 
.ZZ 
celularZZ !
==ZZ" $
userZZ% )
.ZZ) *
celularZZ* 1
)ZZ1 2
||ZZ3 5
_context[[  
.[[  !
Empresas[[! )
.[[) *
Any[[* -
([[- .
e[[. /
=>[[0 2
e[[3 4
.[[4 5
celular[[5 <
==[[= ?
user[[@ D
.[[D E
celular[[E L
)[[L M
||[[N P
_context\\  
.\\  !
Pagos\\! &
.\\& '
Any\\' *
(\\* +
p\\+ ,
=>\\- /
p\\0 1
.\\1 2
Descripcion\\2 =
==\\> @
user\\A E
.\\E F
celular\\F M
)\\M N
)\\N O
{]] 
if^^ 
(^^ 
_context^^ $
.^^$ %
Usuarios^^% -
.^^- .
Any^^. 1
(^^1 2
u^^2 3
=>^^4 6
u^^7 8
.^^8 9
usuario^^9 @
==^^A C
user^^D H
.^^H I
usuario^^I P
)^^P Q
)^^Q R

ModelState__ &
.__& '
AddModelError__' 4
(__4 5
$str__5 >
,__> ?
$str__@ f
)__f g
;__g h
ifaa 
(aa 
_contextaa $
.aa$ %
Usuariosaa% -
.aa- .
Anyaa. 1
(aa1 2
uaa2 3
=>aa4 6
uaa7 8
.aa8 9
correoaa9 ?
==aa@ B
useraaC G
.aaG H
correoaaH N
)aaN O
)aaO P

ModelStatebb &
.bb& '
AddModelErrorbb' 4
(bb4 5
$strbb5 =
,bb= >
$strbb? f
)bbf g
;bbg h
ifdd 
(dd 
_contextdd $
.dd$ %
Usuariosdd% -
.dd- .
Anydd. 1
(dd1 2
udd2 3
=>dd4 6
udd7 8
.dd8 9
	documentodd9 B
==ddC E
userddF J
.ddJ K
	documentoddK T
)ddT U
)ddU V

ModelStateee &
.ee& '
AddModelErroree' 4
(ee4 5
$stree5 @
,ee@ A
$streeB l
)eel m
;eem n
ifgg 
(gg 
_contextgg $
.gg$ %
Usuariosgg% -
.gg- .
Anygg. 1
(gg1 2
ugg2 3
=>gg4 6
ugg7 8
.gg8 9
celulargg9 @
==ggA C
userggD H
.ggH I
celularggI P
)ggP Q
||ggR T
_contexthh  
.hh  !
Empresashh! )
.hh) *
Anyhh* -
(hh- .
ehh. /
=>hh0 2
ehh3 4
.hh4 5
celularhh5 <
==hh= ?
userhh@ D
.hhD E
celularhhE L
)hhL M
||hhN P
_contextii  
.ii  !
Pagosii! &
.ii& '
Anyii' *
(ii* +
pii+ ,
=>ii- /
pii0 1
.ii1 2
Descripcionii2 =
==ii> @
useriiA E
.iiE F
celulariiF M
)iiM N
)iiN O

ModelStatejj &
.jj& '
AddModelErrorjj' 4
(jj4 5
$strjj5 >
,jj> ?
$strjj@ s
)jjs t
;jjt u
returnll 
Viewll #
(ll# $
userll$ (
)ll( )
;ll) *
}mm 
_contextoo 
.oo 
Usuariosoo %
.oo% &
Addoo& )
(oo) *
useroo* .
)oo. /
;oo/ 0
_contextpp 
.pp 
SaveChangespp (
(pp( )
)pp) *
;pp* +
ViewDataqq 
[qq 
$strqq &
]qq& '
=qq( )
$strqq* K
;qqK L
returnrr 
RedirectToActionrr +
(rr+ ,
$strrr, 3
,rr3 4
$strrr5 =
)rr= >
;rr> ?
}ss 
}tt 
returnuu 
Viewuu 
(uu 
)uu 
;uu 
}vv 	
private 
Usuarios 
validarCredenciales ,
(, -
string- 3
alias4 9
,9 :
string; A
claveB G
)G H
{
ÄÄ 	
clave
ÅÅ 
=
ÅÅ 
	Encriptar
ÅÅ 
(
ÅÅ 
clave
ÅÅ #
)
ÅÅ# $
;
ÅÅ$ %
var
ÇÇ 
tipo_usuario
ÇÇ 
=
ÇÇ 
_context
ÇÇ '
.
ÇÇ' (
Usuarios
ÇÇ( 0
.
ÇÇ0 1
Include
ÇÇ1 8
(
ÇÇ8 9
r
ÇÇ9 :
=>
ÇÇ; =
r
ÇÇ> ?
.
ÇÇ? @
Rol
ÇÇ@ C
)
ÇÇC D
.
ÉÉ$ %
Where
ÉÉ% *
(
ÉÉ* +
u
ÉÉ+ ,
=>
ÉÉ- /
u
ÉÉ0 1
.
ÉÉ1 2
usuario
ÉÉ2 9
==
ÉÉ: <
alias
ÉÉ= B
)
ÉÉB C
.
ÑÑ$ %
Where
ÑÑ% *
(
ÑÑ* +
u
ÑÑ+ ,
=>
ÑÑ- /
u
ÑÑ0 1
.
ÑÑ1 2
pass
ÑÑ2 6
==
ÑÑ7 9
clave
ÑÑ: ?
)
ÑÑ? @
.
ÖÖ$ %
FirstOrDefault
ÖÖ% 3
(
ÖÖ3 4
)
ÖÖ4 5
;
ÖÖ5 6
return
ÜÜ 
tipo_usuario
ÜÜ 
;
ÜÜ  
}
áá 	
public
ââ 
static
ââ 
string
ââ 
	Encriptar
ââ &
(
ââ& '
string
ââ' -
texto
ââ. 3
)
ââ3 4
{
ää 	
StringBuilder
ãã 
sb
ãã 
=
ãã 
new
ãã "
StringBuilder
ãã# 0
(
ãã0 1
)
ãã1 2
;
ãã2 3
using
åå 
(
åå 
SHA256
åå 
hash
åå 
=
åå  
SHA256
åå! '
.
åå' (
Create
åå( .
(
åå. /
)
åå/ 0
)
åå0 1
{
çç 
Encoding
éé 
enc
éé 
=
éé 
Encoding
éé '
.
éé' (
UTF8
éé( ,
;
éé, -
byte
èè 
[
èè 
]
èè 
result
èè 
=
èè 
hash
èè  $
.
èè$ %
ComputeHash
èè% 0
(
èè0 1
enc
èè1 4
.
èè4 5
GetBytes
èè5 =
(
èè= >
texto
èè> C
)
èèC D
)
èèD E
;
èèE F
foreach
êê 
(
êê 
byte
êê 
b
êê 
in
êê  "
result
êê# )
)
êê) *
{
ëë 
sb
íí 
.
íí 
Append
íí 
(
íí 
b
íí 
.
íí  
ToString
íí  (
(
íí( )
$str
íí) -
)
íí- .
)
íí. /
;
íí/ 0
}
ìì 
}
îî 
return
ïï 
sb
ïï 
.
ïï 
ToString
ïï 
(
ïï 
)
ïï  
;
ïï  !
}
ññ 	
[
òò 	
HttpGet
òò	 
]
òò 
public
ôô 
IActionResult
ôô 
AdminRegistro
ôô *
(
ôô* +
)
ôô+ ,
{
öö 	
return
õõ 
View
õõ 
(
õõ 
)
õõ 
;
õõ 
}
úú 	
[
ûû 	
HttpPost
ûû	 
]
ûû 
public
üü 
IActionResult
üü 
AdminRegistro
üü *
(
üü* +
Usuarios
üü+ 3
user
üü4 8
)
üü8 9
{
†† 	
if
°° 
(
°° 
user
°° 
.
°° 
pass
°° 
!=
°° 
null
°° !
)
°°! "
{
¢¢ 
user
££ 
.
££ 
pass
££ 
=
££ 
	Encriptar
££ %
(
££% &
user
££& *
.
££* +
pass
££+ /
)
££/ 0
;
££0 1
user
§§ 
.
§§ 
id_rol
§§ 
=
§§ 
$num
§§ 
;
§§  
if
•• 
(
•• 

ModelState
•• 
.
•• 
IsValid
•• &
)
••& '
{
¶¶ 
if
®® 
(
®® 
_context
®®  
.
®®  !
Usuarios
®®! )
.
®®) *
Any
®®* -
(
®®- .
u
®®. /
=>
®®0 2
u
©© 
.
©© 
usuario
©© !
==
©©" $
user
©©% )
.
©©) *
usuario
©©* 1
||
©©2 4
u
™™ 
.
™™ 
correo
™™  
==
™™! #
user
™™$ (
.
™™( )
correo
™™) /
||
™™0 2
u
´´ 
.
´´ 
	documento
´´ #
==
´´$ &
user
´´' +
.
´´+ ,
	documento
´´, 5
||
´´6 8
u
¨¨ 
.
¨¨ 
celular
¨¨ !
==
¨¨" $
user
¨¨% )
.
¨¨) *
celular
¨¨* 1
)
¨¨1 2
||
¨¨3 5
_context
≠≠  
.
≠≠  !
Empresas
≠≠! )
.
≠≠) *
Any
≠≠* -
(
≠≠- .
e
≠≠. /
=>
≠≠0 2
e
≠≠3 4
.
≠≠4 5
celular
≠≠5 <
==
≠≠= ?
user
≠≠@ D
.
≠≠D E
celular
≠≠E L
)
≠≠L M
||
≠≠N P
_context
ÆÆ  
.
ÆÆ  !
Pagos
ÆÆ! &
.
ÆÆ& '
Any
ÆÆ' *
(
ÆÆ* +
p
ÆÆ+ ,
=>
ÆÆ- /
p
ÆÆ0 1
.
ÆÆ1 2
Descripcion
ÆÆ2 =
==
ÆÆ> @
user
ÆÆA E
.
ÆÆE F
celular
ÆÆF M
)
ÆÆM N
)
ÆÆN O
{
ØØ 
if
∞∞ 
(
∞∞ 
_context
∞∞ $
.
∞∞$ %
Usuarios
∞∞% -
.
∞∞- .
Any
∞∞. 1
(
∞∞1 2
u
∞∞2 3
=>
∞∞4 6
u
∞∞7 8
.
∞∞8 9
usuario
∞∞9 @
==
∞∞A C
user
∞∞D H
.
∞∞H I
usuario
∞∞I P
)
∞∞P Q
)
∞∞Q R

ModelState
±± &
.
±±& '
AddModelError
±±' 4
(
±±4 5
$str
±±5 >
,
±±> ?
$str
±±@ f
)
±±f g
;
±±g h
if
≥≥ 
(
≥≥ 
_context
≥≥ $
.
≥≥$ %
Usuarios
≥≥% -
.
≥≥- .
Any
≥≥. 1
(
≥≥1 2
u
≥≥2 3
=>
≥≥4 6
u
≥≥7 8
.
≥≥8 9
correo
≥≥9 ?
==
≥≥@ B
user
≥≥C G
.
≥≥G H
correo
≥≥H N
)
≥≥N O
)
≥≥O P

ModelState
¥¥ &
.
¥¥& '
AddModelError
¥¥' 4
(
¥¥4 5
$str
¥¥5 =
,
¥¥= >
$str
¥¥? f
)
¥¥f g
;
¥¥g h
if
∂∂ 
(
∂∂ 
_context
∂∂ $
.
∂∂$ %
Usuarios
∂∂% -
.
∂∂- .
Any
∂∂. 1
(
∂∂1 2
u
∂∂2 3
=>
∂∂4 6
u
∂∂7 8
.
∂∂8 9
	documento
∂∂9 B
==
∂∂C E
user
∂∂F J
.
∂∂J K
	documento
∂∂K T
)
∂∂T U
)
∂∂U V

ModelState
∑∑ &
.
∑∑& '
AddModelError
∑∑' 4
(
∑∑4 5
$str
∑∑5 @
,
∑∑@ A
$str
∑∑B l
)
∑∑l m
;
∑∑m n
if
ππ 
(
ππ 
_context
ππ $
.
ππ$ %
Usuarios
ππ% -
.
ππ- .
Any
ππ. 1
(
ππ1 2
u
ππ2 3
=>
ππ4 6
u
ππ7 8
.
ππ8 9
celular
ππ9 @
==
ππA C
user
ππD H
.
ππH I
celular
ππI P
)
ππP Q
||
ππR T
_context
∫∫  
.
∫∫  !
Empresas
∫∫! )
.
∫∫) *
Any
∫∫* -
(
∫∫- .
e
∫∫. /
=>
∫∫0 2
e
∫∫3 4
.
∫∫4 5
celular
∫∫5 <
==
∫∫= ?
user
∫∫@ D
.
∫∫D E
celular
∫∫E L
)
∫∫L M
||
∫∫N P
_context
ªª  
.
ªª  !
Pagos
ªª! &
.
ªª& '
Any
ªª' *
(
ªª* +
p
ªª+ ,
=>
ªª- /
p
ªª0 1
.
ªª1 2
Descripcion
ªª2 =
==
ªª> @
user
ªªA E
.
ªªE F
celular
ªªF M
)
ªªM N
)
ªªN O

ModelState
ºº &
.
ºº& '
AddModelError
ºº' 4
(
ºº4 5
$str
ºº5 >
,
ºº> ?
$str
ºº@ s
)
ººs t
;
ººt u
return
ææ 
View
ææ #
(
ææ# $
user
ææ$ (
)
ææ( )
;
ææ) *
}
øø 
_context
¡¡ 
.
¡¡ 
Usuarios
¡¡ %
.
¡¡% &
Add
¡¡& )
(
¡¡) *
user
¡¡* .
)
¡¡. /
;
¡¡/ 0
_context
¬¬ 
.
¬¬ 
SaveChanges
¬¬ (
(
¬¬( )
)
¬¬) *
;
¬¬* +
ViewData
√√ 
[
√√ 
$str
√√ &
]
√√& '
=
√√( )
$str
√√* K
;
√√K L
return
ƒƒ 
RedirectToAction
ƒƒ +
(
ƒƒ+ ,
$str
ƒƒ, 3
,
ƒƒ3 4
$str
ƒƒ5 =
)
ƒƒ= >
;
ƒƒ> ?
}
≈≈ 
}
∆∆ 
return
«« 
View
«« 
(
«« 
)
«« 
;
«« 
}
»» 	
}
…… 
}   öá
wC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Controllers\CanchasController.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $
Controllers$ /
{ 
public 

class 
CanchasController "
:# $

Controller% /
{ 
private 
readonly 
AppDbContext %
_context& .
;. /
public 
CanchasController  
(  !
AppDbContext! -
context. 5
)5 6
{ 	
_context 
= 
context 
; 
} 	
[ 	
	Authorize	 
( 
Roles 
= 
$str 6
)6 7
]7 8
public 
async 
Task 
< 
IActionResult '
>' (
Index) .
(. /
)/ 0
{ 	
var 
appDbContext 
= 
_context '
.' (
Canchas( /
./ 0
Include0 7
(7 8
c8 9
=>: <
c= >
.> ?
Empresa? F
)F G
;G H
return 
View 
( 
await 
appDbContext *
.* +
ToListAsync+ 6
(6 7
)7 8
)8 9
;9 :
} 	
[   	
	Authorize  	 
(   
Roles   
=   
$str   3
)  3 4
]  4 5
public!! 
async!! 
Task!! 
<!! 
IActionResult!! '
>!!' (
Details!!) 0
(!!0 1
int!!1 4
?!!4 5
id!!6 8
,!!8 9
DateTime!!: B
?!!B C
fechaSeleccionada!!D U
)!!U V
{"" 	
if## 
(## 
id## 
==## 
null## 
||## 
_context## &
.##& '
Canchas##' .
==##/ 1
null##2 6
)##6 7
{$$ 
return%% 
NotFound%% 
(%%  
)%%  !
;%%! "
}&& 
var(( 
canchas(( 
=(( 
await(( 
_context((  (
.((( )
Canchas(() 0
.)) 
Include)) 
()) 
c)) 
=>)) 
c)) 
.))  
Empresa))  '
)))' (
.** 
FirstOrDefaultAsync** $
(**$ %
m**% &
=>**' )
m*** +
.**+ ,
	id_cancha**, 5
==**6 8
id**9 ;
)**; <
;**< =
if,, 
(,, 
canchas,, 
==,, 
null,, 
),,  
{-- 
return.. 
NotFound.. 
(..  
)..  !
;..! "
}// 
DateTime00 
fechaReserva200 "
=00# $
fechaSeleccionada00% 6
??007 9
DateTime00: B
.00B C
Now00C F
;00F G
var11 
(11 
numeroHoras11 
,11 
horasReservadas11 -
,11- .
fechaReserva11/ ;
)11; <
=11= >"
ObtenerHorasReservadas11? U
(11U V
canchas11V ]
,11] ^
fechaReserva211_ l
)11l m
;11m n
ViewBag33 
.33 
HorasReservadas33 #
=33$ %
horasReservadas33& 5
;335 6
ViewBag44 
.44 
NumeroHoras44 
=44  !
numeroHoras44" -
;44- .
ViewBag55 
.55 
fechaReserva55  
=55! "
fechaReserva55# /
;55/ 0
return77 
View77 
(77 
canchas77 
)77  
;77  !
}88 	
[;; 	
	Authorize;;	 
(;; 
Roles;; 
=;; 
$str;; *
);;* +
];;+ ,
public<< 
IActionResult<< 
Create<< #
(<<# $
)<<$ %
{== 	
ViewData>> 
[>> 
$str>> !
]>>! "
=>># $
new>>% (

SelectList>>) 3
(>>3 4
_context>>4 <
.>>< =
Empresas>>= E
,>>E F
$str>>G S
,>>S T
$str>>U ]
)>>] ^
;>>^ _
return?? 
View?? 
(?? 
)?? 
;?? 
}@@ 	
[EE 	
HttpPostEE	 
]EE 
[FF 	$
ValidateAntiForgeryTokenFF	 !
]FF! "
publicGG 
asyncGG 
TaskGG 
<GG 
IActionResultGG '
>GG' (
CreateGG) /
(GG/ 0
CanchasGG0 7
canchasGG8 ?
)GG? @
{HH 	
ifII 
(II 

ModelStateII 
.II 
IsValidII "
)II" #
{JJ 
_contextKK 
.KK 
AddKK 
(KK 
canchasKK $
)KK$ %
;KK% &
awaitLL 
_contextLL 
.LL 
SaveChangesAsyncLL /
(LL/ 0
)LL0 1
;LL1 2
returnMM 
RedirectToActionMM '
(MM' (
nameofMM( .
(MM. /
IndexMM/ 4
)MM4 5
)MM5 6
;MM6 7
}NN 
ViewDataOO 
[OO 
$strOO !
]OO! "
=OO# $
newOO% (

SelectListOO) 3
(OO3 4
_contextOO4 <
.OO< =
EmpresasOO= E
,OOE F
$strOOG S
,OOS T
$strOOU ]
,OO] ^
canchasOO_ f
.OOf g

id_empresaOOg q
)OOq r
;OOr s
returnPP 
ViewPP 
(PP 
canchasPP 
)PP  
;PP  !
}QQ 	
[TT 	
	AuthorizeTT	 
(TT 
RolesTT 
=TT 
$strTT *
)TT* +
]TT+ ,
publicUU 
asyncUU 
TaskUU 
<UU 
IActionResultUU '
>UU' (
EditUU) -
(UU- .
intUU. 1
?UU1 2
idUU3 5
)UU5 6
{VV 	
ifWW 
(WW 
idWW 
==WW 
nullWW 
||WW 
_contextWW &
.WW& '
CanchasWW' .
==WW/ 1
nullWW2 6
)WW6 7
{XX 
returnYY 
NotFoundYY 
(YY  
)YY  !
;YY! "
}ZZ 
var\\ 
canchas\\ 
=\\ 
await\\ 
_context\\  (
.\\( )
Canchas\\) 0
.\\0 1
	FindAsync\\1 :
(\\: ;
id\\; =
)\\= >
;\\> ?
if]] 
(]] 
canchas]] 
==]] 
null]] 
)]]  
{^^ 
return__ 
NotFound__ 
(__  
)__  !
;__! "
}`` 
ViewDataaa 
[aa 
$straa !
]aa! "
=aa# $
newaa% (

SelectListaa) 3
(aa3 4
_contextaa4 <
.aa< =
Empresasaa= E
,aaE F
$straaG S
,aaS T
$straaU ]
,aa] ^
canchasaa_ f
.aaf g

id_empresaaag q
)aaq r
;aar s
returnbb 
Viewbb 
(bb 
canchasbb 
)bb  
;bb  !
}cc 	
[hh 	
HttpPosthh	 
]hh 
[ii 	$
ValidateAntiForgeryTokenii	 !
]ii! "
publicjj 
asyncjj 
Taskjj 
<jj 
IActionResultjj '
>jj' (
Editjj) -
(jj- .
intjj. 1
idjj2 4
,jj4 5
Canchasjj6 =
canchasjj> E
)jjE F
{kk 	
ifll 
(ll 
idll 
!=ll 
canchasll 
.ll 
	id_canchall '
)ll' (
{mm 
returnnn 
NotFoundnn 
(nn  
)nn  !
;nn! "
}oo 
ifqq 
(qq 

ModelStateqq 
.qq 
IsValidqq "
)qq" #
{rr 
tryss 
{tt 
_contextuu 
.uu 
Updateuu #
(uu# $
canchasuu$ +
)uu+ ,
;uu, -
awaitvv 
_contextvv "
.vv" #
SaveChangesAsyncvv# 3
(vv3 4
)vv4 5
;vv5 6
}ww 
catchxx 
(xx (
DbUpdateConcurrencyExceptionxx 3
)xx3 4
{yy 
ifzz 
(zz 
!zz 
CanchasExistszz &
(zz& '
canchaszz' .
.zz. /
	id_canchazz/ 8
)zz8 9
)zz9 :
{{{ 
return|| 
NotFound|| '
(||' (
)||( )
;||) *
}}} 
else~~ 
{ 
throw
ÄÄ 
;
ÄÄ 
}
ÅÅ 
}
ÇÇ 
return
ÉÉ 
RedirectToAction
ÉÉ '
(
ÉÉ' (
nameof
ÉÉ( .
(
ÉÉ. /
Index
ÉÉ/ 4
)
ÉÉ4 5
)
ÉÉ5 6
;
ÉÉ6 7
}
ÑÑ 
ViewData
ÖÖ 
[
ÖÖ 
$str
ÖÖ !
]
ÖÖ! "
=
ÖÖ# $
new
ÖÖ% (

SelectList
ÖÖ) 3
(
ÖÖ3 4
_context
ÖÖ4 <
.
ÖÖ< =
Empresas
ÖÖ= E
,
ÖÖE F
$str
ÖÖG S
,
ÖÖS T
$str
ÖÖU ]
,
ÖÖ] ^
canchas
ÖÖ_ f
.
ÖÖf g

id_empresa
ÖÖg q
)
ÖÖq r
;
ÖÖr s
return
ÜÜ 
View
ÜÜ 
(
ÜÜ 
canchas
ÜÜ 
)
ÜÜ  
;
ÜÜ  !
}
áá 	
[
ää 	
	Authorize
ää	 
(
ää 
Roles
ää 
=
ää 
$str
ää *
)
ää* +
]
ää+ ,
public
ãã 
async
ãã 
Task
ãã 
<
ãã 
IActionResult
ãã '
>
ãã' (
Delete
ãã) /
(
ãã/ 0
int
ãã0 3
?
ãã3 4
id
ãã5 7
)
ãã7 8
{
åå 	
if
çç 
(
çç 
id
çç 
==
çç 
null
çç 
||
çç 
_context
çç &
.
çç& '
Canchas
çç' .
==
çç/ 1
null
çç2 6
)
çç6 7
{
éé 
return
èè 
NotFound
èè 
(
èè  
)
èè  !
;
èè! "
}
êê 
var
íí 
canchas
íí 
=
íí 
await
íí 
_context
íí  (
.
íí( )
Canchas
íí) 0
.
ìì 
Include
ìì 
(
ìì 
c
ìì 
=>
ìì 
c
ìì 
.
ìì  
Empresa
ìì  '
)
ìì' (
.
îî !
FirstOrDefaultAsync
îî $
(
îî$ %
m
îî% &
=>
îî' )
m
îî* +
.
îî+ ,
	id_cancha
îî, 5
==
îî6 8
id
îî9 ;
)
îî; <
;
îî< =
if
ïï 
(
ïï 
canchas
ïï 
==
ïï 
null
ïï 
)
ïï  
{
ññ 
return
óó 
NotFound
óó 
(
óó  
)
óó  !
;
óó! "
}
òò 
return
öö 
View
öö 
(
öö 
canchas
öö 
)
öö  
;
öö  !
}
õõ 	
[
ûû 	
HttpPost
ûû	 
,
ûû 

ActionName
ûû 
(
ûû 
$str
ûû &
)
ûû& '
]
ûû' (
[
üü 	&
ValidateAntiForgeryToken
üü	 !
]
üü! "
public
†† 
async
†† 
Task
†† 
<
†† 
IActionResult
†† '
>
††' (
DeleteConfirmed
††) 8
(
††8 9
int
††9 <
id
††= ?
)
††? @
{
°° 	
if
¢¢ 
(
¢¢ 
_context
¢¢ 
.
¢¢ 
Canchas
¢¢  
==
¢¢! #
null
¢¢$ (
)
¢¢( )
{
££ 
return
§§ 
Problem
§§ 
(
§§ 
$str
§§ L
)
§§L M
;
§§M N
}
•• 
var
¶¶ 
canchas
¶¶ 
=
¶¶ 
await
¶¶ 
_context
¶¶  (
.
¶¶( )
Canchas
¶¶) 0
.
¶¶0 1
	FindAsync
¶¶1 :
(
¶¶: ;
id
¶¶; =
)
¶¶= >
;
¶¶> ?
if
ßß 
(
ßß 
canchas
ßß 
!=
ßß 
null
ßß 
)
ßß  
{
®® 
_context
©© 
.
©© 
Canchas
©©  
.
©©  !
Remove
©©! '
(
©©' (
canchas
©©( /
)
©©/ 0
;
©©0 1
}
™™ 
await
¨¨ 
_context
¨¨ 
.
¨¨ 
SaveChangesAsync
¨¨ +
(
¨¨+ ,
)
¨¨, -
;
¨¨- .
return
≠≠ 
RedirectToAction
≠≠ #
(
≠≠# $
nameof
≠≠$ *
(
≠≠* +
Index
≠≠+ 0
)
≠≠0 1
)
≠≠1 2
;
≠≠2 3
}
ÆÆ 	
private
∞∞ 
bool
∞∞ 
CanchasExists
∞∞ "
(
∞∞" #
int
∞∞# &
id
∞∞' )
)
∞∞) *
{
±± 	
return
≤≤ 
(
≤≤ 
_context
≤≤ 
.
≤≤ 
Canchas
≤≤ $
?
≤≤$ %
.
≤≤% &
Any
≤≤& )
(
≤≤) *
e
≤≤* +
=>
≤≤, .
e
≤≤/ 0
.
≤≤0 1
	id_cancha
≤≤1 :
==
≤≤; =
id
≤≤> @
)
≤≤@ A
)
≤≤A B
.
≤≤B C
GetValueOrDefault
≤≤C T
(
≤≤T U
)
≤≤U V
;
≤≤V W
}
≥≥ 	
private
µµ 
(
µµ 
int
µµ 
numeroHoras
µµ  
,
µµ  !
List
µµ" &
<
µµ& '
TimeSpan
µµ' /
>
µµ/ 0
horasReservadas
µµ1 @
,
µµ@ A
DateTime
µµB J
fechaReserva
µµK W
)
µµW X$
ObtenerHorasReservadas
µµY o
(
µµo p
Canchas
µµp w
cancha
µµx ~
,
µµ~ 
DateTimeµµÄ à!
fechaSeleccionadaµµâ ö
)µµö õ
{
∂∂ 	
var
∏∏ 
reservas
∏∏ 
=
∏∏ 
_context
∏∏ #
.
∏∏# $
Reservas
∏∏$ ,
.
ππ 
Where
ππ 
(
ππ 
r
ππ 
=>
ππ 
r
ππ 
.
ππ 
CampoID
ππ %
==
ππ& (
cancha
ππ) /
.
ππ/ 0
	id_cancha
ππ0 9
&&
ππ: <
r
ππ= >
.
ππ> ?
fechaReserva
ππ? K
.
ππK L
Date
ππL P
==
ππQ S
DateTime
ππT \
.
ππ\ ]
Now
ππ] `
.
ππ` a
Date
ππa e
)
ππe f
.
∫∫ 
ToList
∫∫ 
(
∫∫ 
)
∫∫ 
;
∫∫ 
var
ΩΩ 
horasReservadas
ΩΩ 
=
ΩΩ  !
new
ΩΩ" %
List
ΩΩ& *
<
ΩΩ* +
TimeSpan
ΩΩ+ 3
>
ΩΩ3 4
(
ΩΩ4 5
)
ΩΩ5 6
;
ΩΩ6 7
foreach
ææ 
(
ææ 
var
ææ 
reserva
ææ  
in
ææ! #
reservas
ææ$ ,
)
ææ, -
{
øø 
var
¿¿ 
horaReserva
¿¿ 
=
¿¿  !
reserva
¿¿" )
.
¿¿) *
horaReserva
¿¿* 5
;
¿¿5 6
for
¡¡ 
(
¡¡ 
int
¡¡ 
i
¡¡ 
=
¡¡ 
$num
¡¡ 
;
¡¡ 
i
¡¡  !
<
¡¡" #
reserva
¡¡$ +
.
¡¡+ ,
numeroHoras
¡¡, 7
;
¡¡7 8
i
¡¡9 :
++
¡¡: <
)
¡¡< =
{
¬¬ 
horasReservadas
√√ #
.
√√# $
Add
√√$ '
(
√√' (
horaReserva
√√( 3
)
√√3 4
;
√√4 5
horaReserva
ƒƒ 
=
ƒƒ  !
horaReserva
ƒƒ" -
.
ƒƒ- .
Add
ƒƒ. 1
(
ƒƒ1 2
TimeSpan
ƒƒ2 :
.
ƒƒ: ;
	FromHours
ƒƒ; D
(
ƒƒD E
$num
ƒƒE F
)
ƒƒF G
)
ƒƒG H
;
ƒƒH I
}
≈≈ 
}
∆∆ 
int
…… 
numeroHoras
…… 
=
…… 
reservas
…… &
.
……& '
Sum
……' *
(
……* +
r
……+ ,
=>
……- /
r
……0 1
.
……1 2
numeroHoras
……2 =
)
……= >
;
……> ?
DateTime
ÃÃ 
fechaReserva
ÃÃ !
=
ÃÃ" #
reservas
ÃÃ$ ,
.
ÃÃ, -
FirstOrDefault
ÃÃ- ;
(
ÃÃ; <
)
ÃÃ< =
?
ÃÃ= >
.
ÃÃ> ?
fechaReserva
ÃÃ? K
.
ÃÃK L
Date
ÃÃL P
??
ÃÃQ S
DateTime
ÃÃT \
.
ÃÃ\ ]
MinValue
ÃÃ] e
;
ÃÃe f
return
ŒŒ 
(
ŒŒ 
numeroHoras
ŒŒ 
,
ŒŒ  
horasReservadas
ŒŒ! 0
,
ŒŒ0 1
fechaReserva
ŒŒ2 >
)
ŒŒ> ?
;
ŒŒ? @
}
œœ 	
}
—— 
}““ –æ
xC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Controllers\EmpresasController.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $
Controllers$ /
{ 
public 

class 
EmpresasController #
:$ %

Controller& 0
{ 
private 
readonly 
AppDbContext %
_context& .
;. /
public 
EmpresasController !
(! "
AppDbContext" .
context/ 6
)6 7
{ 	
_context 
= 
context 
; 
} 	
[ 	
	Authorize	 
( 
Roles 
= 
$str 6
)6 7
]7 8
public 
async 
Task 
< 
IActionResult '
>' (
Index) .
(. /
)/ 0
{ 	
var 
userId 
= 
User 
. 
FindFirstValue ,
(, -

ClaimTypes- 7
.7 8
NameIdentifier8 F
)F G
;G H
var   
empresasDelUsuario   "
=  # $
_context  % -
.  - .
User_Empresa  . :
.!! 
Where!! 
(!! 
ue!! 
=>!! 
ue!! 
.!!  

id_usuario!!  *
==!!+ -
int!!. 1
.!!1 2
Parse!!2 7
(!!7 8
userId!!8 >
)!!> ?
)!!? @
."" 
Select"" 
("" 
ue"" 
=>"" 
ue""  
.""  !
Empresa""! (
)""( )
;"") *
return$$ 
View$$ 
($$ 
await$$ 
empresasDelUsuario$$ 0
.$$0 1
ToListAsync$$1 <
($$< =
)$$= >
)$$> ?
;$$? @
}%% 	
public)) 
async)) 
Task)) 
<)) 
IActionResult)) '
>))' (
Details))) 0
())0 1
int))1 4
?))4 5
id))6 8
)))8 9
{** 	
if++ 
(++ 
id++ 
==++ 
null++ 
||++ 
_context++ &
.++& '
Empresas++' /
==++0 2
null++3 7
)++7 8
{,, 
return-- 
NotFound-- 
(--  
)--  !
;--! "
}.. 
var00 
empresas00 
=00 
await00  
_context00! )
.00) *
Empresas00* 2
.11 
FirstOrDefaultAsync11 $
(11$ %
m11% &
=>11' )
m11* +
.11+ ,

id_empresa11, 6
==117 9
id11: <
)11< =
;11= >
if22 
(22 
empresas22 
==22 
null22  
)22  !
{33 
return44 
NotFound44 
(44  
)44  !
;44! "
}55 
return77 
View77 
(77 
empresas77  
)77  !
;77! "
}88 	
[;; 	
	Authorize;;	 
(;; 
Roles;; 
=;; 
$str;; *
);;* +
];;+ ,
public<< 
IActionResult<< 
Create<< #
(<<# $
)<<$ %
{== 	
ViewData?? 
[?? 
$str?? 
]??  
=??! "
new??# &

SelectList??' 1
(??1 2
_context??2 :
.??: ;
Pagos??; @
,??@ A
$str??B L
,??L M
$str??N V
)??V W
;??W X
returnAA 
ViewAA 
(AA 
)AA 
;AA 
}BB 	
[GG 	
HttpPostGG	 
]GG 
[HH 	$
ValidateAntiForgeryTokenHH	 !
]HH! "
publicJJ 
asyncJJ 
TaskJJ 
<JJ 
IActionResultJJ '
>JJ' (
CreateJJ) /
(JJ/ 0
EmpresasJJ0 8
empresasJJ9 A
)JJA B
{KK 	
ifLL 
(LL 

ModelStateLL 
.LL 
IsValidLL "
)LL" #
{MM 
ifOO 
(OO 
_contextOO 
.OO 
EmpresasOO %
.OO% &
AnyOO& )
(OO) *
eOO* +
=>OO, .
ePP 
.PP 
nombrePP 
==PP 
empresasPP  (
.PP( )
nombrePP) /
||PP0 2
eQQ 
.QQ 
correoQQ 
==QQ 
empresasQQ  (
.QQ( )
correoQQ) /
||QQ0 2
eRR 
.RR 
celularRR 
==RR  
empresasRR! )
.RR) *
celularRR* 1
)RR1 2
||RR3 5
_contextSS 
.SS 
UsuariosSS %
.SS% &
AnySS& )
(SS) *
uSS* +
=>SS, .
uSS/ 0
.SS0 1
celularSS1 8
==SS9 ;
empresasSS< D
.SSD E
celularSSE L
)SSL M
||SSN P
_contextTT 
.TT 
PagosTT "
.TT" #
AnyTT# &
(TT& '
omTT' )
=>TT* ,
omTT- /
.TT/ 0
DescripcionTT0 ;
==TT< >
empresasTT? G
.TTG H
celularTTH O
)TTO P
)TTP Q
{UU 
ifVV 
(VV 
_contextVV  
.VV  !
EmpresasVV! )
.VV) *
AnyVV* -
(VV- .
eVV. /
=>VV0 2
eVV3 4
.VV4 5
nombreVV5 ;
==VV< >
empresasVV? G
.VVG H
nombreVVH N
)VVN O
)VVO P

ModelStateWW "
.WW" #
AddModelErrorWW# 0
(WW0 1
$strWW1 9
,WW9 :
$strWW; c
)WWc d
;WWd e
ifYY 
(YY 
_contextYY  
.YY  !
EmpresasYY! )
.YY) *
AnyYY* -
(YY- .
eYY. /
=>YY0 2
eYY3 4
.YY4 5
correoYY5 ;
==YY< >
empresasYY? G
.YYG H
correoYYH N
)YYN O
)YYO P

ModelStateZZ "
.ZZ" #
AddModelErrorZZ# 0
(ZZ0 1
$strZZ1 9
,ZZ9 :
$strZZ; c
)ZZc d
;ZZd e
if\\ 
(\\ 
_context\\  
.\\  !
Empresas\\! )
.\\) *
Any\\* -
(\\- .
e\\. /
=>\\0 2
e\\3 4
.\\4 5
celular\\5 <
==\\= ?
empresas\\@ H
.\\H I
celular\\I P
)\\P Q
||\\R T
_context]] 
.]] 
Usuarios]] %
.]]% &
Any]]& )
(]]) *
u]]* +
=>]], .
u]]/ 0
.]]0 1
celular]]1 8
==]]9 ;
empresas]]< D
.]]D E
celular]]E L
)]]L M
||]]N P
_context^^ 
.^^ 
Pagos^^ "
.^^" #
Any^^# &
(^^& '
om^^' )
=>^^* ,
om^^- /
.^^/ 0
Descripcion^^0 ;
==^^< >
empresas^^? G
.^^G H
celular^^H O
)^^O P
)^^P Q

ModelState__ "
.__" #
AddModelError__# 0
(__0 1
$str__1 :
,__: ;
$str__< o
)__o p
;__p q
ViewDataaa 
[aa 
$straa '
]aa' (
=aa) *
newaa+ .

SelectListaa/ 9
(aa9 :
_contextaa: B
.aaB C
PagosaaC H
,aaH I
$straaJ T
,aaT U
$straaV ^
)aa^ _
;aa_ `
returnbb 
Viewbb 
(bb  
empresasbb  (
)bb( )
;bb) *
}cc 
ifff 
(ff 
empresasff 
.ff 

horaCierreff '
<=ff( *
empresasff+ 3
.ff3 4
horaAperturaff4 @
)ff@ A
{gg 

ModelStateii 
.ii 
AddModelErrorii ,
(ii, -
$strii- 9
,ii9 :
$strii; v
)iiv w
;iiw x
ViewDatall 
[ll 
$strll '
]ll' (
=ll) *
newll+ .

SelectListll/ 9
(ll9 :
_contextll: B
.llB C
PagosllC H
,llH I
$strllJ T
,llT U
$strllV ^
)ll^ _
;ll_ `
returnnn 
Viewnn 
(nn  
empresasnn  (
)nn( )
;nn) *
}oo 
varrr 
diferenciaHorasrr #
=rr$ %
empresasrr& .
.rr. /
DiferenciaHorasrr/ >
;rr> ?
_contextuu 
.uu 
Adduu 
(uu 
empresasuu %
)uu% &
;uu& '
awaitvv 
_contextvv 
.vv 
SaveChangesAsyncvv /
(vv/ 0
)vv0 1
;vv1 2
varyy 
idEmpresaCreadayy #
=yy$ %
empresasyy& .
.yy. /

id_empresayy/ 9
;yy9 :
var|| 
userId|| 
=|| 
User|| !
.||! "
FindFirstValue||" 0
(||0 1

ClaimTypes||1 ;
.||; <
NameIdentifier||< J
)||J K
;||K L
var 
userEmpresa 
=  !
new" %
User_Empresa& 2
{
ÄÄ 

id_usuario
ÅÅ 
=
ÅÅ  
int
ÅÅ! $
.
ÅÅ$ %
Parse
ÅÅ% *
(
ÅÅ* +
userId
ÅÅ+ 1
)
ÅÅ1 2
,
ÅÅ2 3

id_empresa
ÇÇ 
=
ÇÇ  
idEmpresaCreada
ÇÇ! 0
}
ÉÉ 
;
ÉÉ 
_context
ÖÖ 
.
ÖÖ 
Add
ÖÖ 
(
ÖÖ 
userEmpresa
ÖÖ (
)
ÖÖ( )
;
ÖÖ) *
await
ÜÜ 
_context
ÜÜ 
.
ÜÜ 
SaveChangesAsync
ÜÜ /
(
ÜÜ/ 0
)
ÜÜ0 1
;
ÜÜ1 2
return
àà 
RedirectToAction
àà '
(
àà' (
nameof
àà( .
(
àà. /
Index
àà/ 4
)
àà4 5
)
àà5 6
;
àà6 7
}
ââ 
ViewData
åå 
[
åå 
$str
åå 
]
åå  
=
åå! "
new
åå# &

SelectList
åå' 1
(
åå1 2
_context
åå2 :
.
åå: ;
Pagos
åå; @
,
åå@ A
$str
ååB L
,
ååL M
$str
ååN V
)
ååV W
;
ååW X
return
èè 
View
èè 
(
èè 
empresas
èè  
)
èè  !
;
èè! "
}
êê 	
[
îî 	
	Authorize
îî	 
(
îî 
Roles
îî 
=
îî 
$str
îî 6
)
îî6 7
]
îî7 8
public
ïï 
async
ïï 
Task
ïï 
<
ïï 
IActionResult
ïï '
>
ïï' (
Edit
ïï) -
(
ïï- .
int
ïï. 1
?
ïï1 2
id
ïï3 5
)
ïï5 6
{
ññ 	
if
óó 
(
óó 
id
óó 
==
óó 
null
óó 
||
óó 
_context
óó &
.
óó& '
Empresas
óó' /
==
óó0 2
null
óó3 7
)
óó7 8
{
òò 
return
ôô 
NotFound
ôô 
(
ôô  
)
ôô  !
;
ôô! "
}
öö 
var
úú 
empresas
úú 
=
úú 
await
úú  
_context
úú! )
.
úú) *
Empresas
úú* 2
.
úú2 3
	FindAsync
úú3 <
(
úú< =
id
úú= ?
)
úú? @
;
úú@ A
if
ùù 
(
ùù 
empresas
ùù 
==
ùù 
null
ùù  
)
ùù  !
{
ûû 
return
üü 
NotFound
üü 
(
üü  
)
üü  !
;
üü! "
}
†† 
return
°° 
View
°° 
(
°° 
empresas
°°  
)
°°  !
;
°°! "
}
¢¢ 	
[
ßß 	
HttpPost
ßß	 
]
ßß 
[
®® 	&
ValidateAntiForgeryToken
®®	 !
]
®®! "
public
©© 
async
©© 
Task
©© 
<
©© 
IActionResult
©© '
>
©©' (
Edit
©©) -
(
©©- .
int
©©. 1
id
©©2 4
,
©©4 5
[
©©6 7
Bind
©©7 ;
(
©©; <
$str
©©< v
)
©©v w
]
©©w x
Empresas©©y Å
empresas©©Ç ä
)©©ä ã
{
™™ 	
if
´´ 
(
´´ 
id
´´ 
!=
´´ 
empresas
´´ 
.
´´ 

id_empresa
´´ )
)
´´) *
{
¨¨ 
return
≠≠ 
NotFound
≠≠ 
(
≠≠  
)
≠≠  !
;
≠≠! "
}
ÆÆ 
if
∞∞ 
(
∞∞ 

ModelState
∞∞ 
.
∞∞ 
IsValid
∞∞ "
)
∞∞" #
{
±± 
if
≥≥ 
(
≥≥ 
_context
≥≥ 
.
≥≥ 
Empresas
≥≥ %
.
≥≥% &
Any
≥≥& )
(
≥≥) *
e
≥≥* +
=>
≥≥, .
(
¥¥ 
e
¥¥ 
.
¥¥ 
nombre
¥¥ 
==
¥¥  
empresas
¥¥! )
.
¥¥) *
nombre
¥¥* 0
&&
¥¥1 3
e
¥¥4 5
.
¥¥5 6

id_empresa
¥¥6 @
!=
¥¥A C
empresas
¥¥D L
.
¥¥L M

id_empresa
¥¥M W
)
¥¥W X
||
¥¥Y [
(
µµ 
e
µµ 
.
µµ 
correo
µµ 
==
µµ  
empresas
µµ! )
.
µµ) *
correo
µµ* 0
&&
µµ1 3
e
µµ4 5
.
µµ5 6

id_empresa
µµ6 @
!=
µµA C
empresas
µµD L
.
µµL M

id_empresa
µµM W
)
µµW X
||
µµY [
(
∂∂ 
e
∂∂ 
.
∂∂ 
celular
∂∂ 
==
∂∂ !
empresas
∂∂" *
.
∂∂* +
celular
∂∂+ 2
&&
∂∂3 5
e
∂∂6 7
.
∂∂7 8

id_empresa
∂∂8 B
!=
∂∂C E
empresas
∂∂F N
.
∂∂N O

id_empresa
∂∂O Y
)
∂∂Y Z
)
∂∂Z [
||
∂∂\ ^
_context
∑∑ 
.
∑∑ 
Usuarios
∑∑ %
.
∑∑% &
Any
∑∑& )
(
∑∑) *
u
∑∑* +
=>
∑∑, .
u
∑∑/ 0
.
∑∑0 1
celular
∑∑1 8
==
∑∑9 ;
empresas
∑∑< D
.
∑∑D E
celular
∑∑E L
)
∑∑L M
||
∑∑N P
_context
∏∏ 
.
∏∏ 
Pagos
∏∏ "
.
∏∏" #
Any
∏∏# &
(
∏∏& '
om
∏∏' )
=>
∏∏* ,
om
∏∏- /
.
∏∏/ 0
Descripcion
∏∏0 ;
==
∏∏< >
empresas
∏∏? G
.
∏∏G H
celular
∏∏H O
)
∏∏O P
)
∏∏P Q
{
ππ 
if
∫∫ 
(
∫∫ 
_context
∫∫  
.
∫∫  !
Empresas
∫∫! )
.
∫∫) *
Any
∫∫* -
(
∫∫- .
e
∫∫. /
=>
∫∫0 2
e
∫∫3 4
.
∫∫4 5
nombre
∫∫5 ;
==
∫∫< >
empresas
∫∫? G
.
∫∫G H
nombre
∫∫H N
&&
∫∫O Q
e
∫∫R S
.
∫∫S T

id_empresa
∫∫T ^
!=
∫∫_ a
empresas
∫∫b j
.
∫∫j k

id_empresa
∫∫k u
)
∫∫u v
)
∫∫v w

ModelState
ªª "
.
ªª" #
AddModelError
ªª# 0
(
ªª0 1
$str
ªª1 9
,
ªª9 :
$str
ªª; c
)
ªªc d
;
ªªd e
if
ΩΩ 
(
ΩΩ 
_context
ΩΩ  
.
ΩΩ  !
Empresas
ΩΩ! )
.
ΩΩ) *
Any
ΩΩ* -
(
ΩΩ- .
e
ΩΩ. /
=>
ΩΩ0 2
e
ΩΩ3 4
.
ΩΩ4 5
correo
ΩΩ5 ;
==
ΩΩ< >
empresas
ΩΩ? G
.
ΩΩG H
correo
ΩΩH N
&&
ΩΩO Q
e
ΩΩR S
.
ΩΩS T

id_empresa
ΩΩT ^
!=
ΩΩ_ a
empresas
ΩΩb j
.
ΩΩj k

id_empresa
ΩΩk u
)
ΩΩu v
)
ΩΩv w

ModelState
ææ "
.
ææ" #
AddModelError
ææ# 0
(
ææ0 1
$str
ææ1 9
,
ææ9 :
$str
ææ; c
)
ææc d
;
ææd e
if
¿¿ 
(
¿¿ 
_context
¿¿  
.
¿¿  !
Empresas
¿¿! )
.
¿¿) *
Any
¿¿* -
(
¿¿- .
e
¿¿. /
=>
¿¿0 2
e
¿¿3 4
.
¿¿4 5
celular
¿¿5 <
==
¿¿= ?
empresas
¿¿@ H
.
¿¿H I
celular
¿¿I P
&&
¿¿Q S
e
¿¿T U
.
¿¿U V

id_empresa
¿¿V `
!=
¿¿a c
empresas
¿¿d l
.
¿¿l m

id_empresa
¿¿m w
)
¿¿w x
||
¿¿y {
_context
¡¡  
.
¡¡  !
Usuarios
¡¡! )
.
¡¡) *
Any
¡¡* -
(
¡¡- .
u
¡¡. /
=>
¡¡0 2
u
¡¡3 4
.
¡¡4 5
celular
¡¡5 <
==
¡¡= ?
empresas
¡¡@ H
.
¡¡H I
celular
¡¡I P
)
¡¡P Q
||
¡¡R T
_context
¬¬  
.
¬¬  !
Pagos
¬¬! &
.
¬¬& '
Any
¬¬' *
(
¬¬* +
om
¬¬+ -
=>
¬¬. 0
om
¬¬1 3
.
¬¬3 4
Descripcion
¬¬4 ?
==
¬¬@ B
empresas
¬¬C K
.
¬¬K L
celular
¬¬L S
)
¬¬S T
)
¬¬T U

ModelState
√√ "
.
√√" #
AddModelError
√√# 0
(
√√0 1
$str
√√1 :
,
√√: ;
$str
√√< o
)
√√o p
;
√√p q
ViewData
≈≈ 
[
≈≈ 
$str
≈≈ '
]
≈≈' (
=
≈≈) *
new
≈≈+ .

SelectList
≈≈/ 9
(
≈≈9 :
_context
≈≈: B
.
≈≈B C
Pagos
≈≈C H
,
≈≈H I
$str
≈≈J T
,
≈≈T U
$str
≈≈V ^
)
≈≈^ _
;
≈≈_ `
return
∆∆ 
View
∆∆ 
(
∆∆  
empresas
∆∆  (
)
∆∆( )
;
∆∆) *
}
«« 
if
   
(
   
empresas
   
.
   

horaCierre
   '
<=
  ( *
empresas
  + 3
.
  3 4
horaApertura
  4 @
)
  @ A
{
ÀÀ 

ModelState
ÃÃ 
.
ÃÃ 
AddModelError
ÃÃ ,
(
ÃÃ, -
$str
ÃÃ- 9
,
ÃÃ9 :
$str
ÃÃ; v
)
ÃÃv w
;
ÃÃw x
ViewData
ÕÕ 
[
ÕÕ 
$str
ÕÕ '
]
ÕÕ' (
=
ÕÕ) *
new
ÕÕ+ .

SelectList
ÕÕ/ 9
(
ÕÕ9 :
_context
ÕÕ: B
.
ÕÕB C
Pagos
ÕÕC H
,
ÕÕH I
$str
ÕÕJ T
,
ÕÕT U
$str
ÕÕV ^
)
ÕÕ^ _
;
ÕÕ_ `
return
ŒŒ 
View
ŒŒ 
(
ŒŒ  
empresas
ŒŒ  (
)
ŒŒ( )
;
ŒŒ) *
}
œœ 
try
—— 
{
““ 
_context
”” 
.
”” 
Update
”” #
(
””# $
empresas
””$ ,
)
””, -
;
””- .
await
‘‘ 
_context
‘‘ "
.
‘‘" #
SaveChangesAsync
‘‘# 3
(
‘‘3 4
)
‘‘4 5
;
‘‘5 6
}
’’ 
catch
÷÷ 
(
÷÷ *
DbUpdateConcurrencyException
÷÷ 3
)
÷÷3 4
{
◊◊ 
if
ÿÿ 
(
ÿÿ 
!
ÿÿ 
EmpresasExists
ÿÿ '
(
ÿÿ' (
empresas
ÿÿ( 0
.
ÿÿ0 1

id_empresa
ÿÿ1 ;
)
ÿÿ; <
)
ÿÿ< =
{
ŸŸ 
return
⁄⁄ 
NotFound
⁄⁄ '
(
⁄⁄' (
)
⁄⁄( )
;
⁄⁄) *
}
€€ 
else
‹‹ 
{
›› 
throw
ﬁﬁ 
;
ﬁﬁ 
}
ﬂﬂ 
}
‡‡ 
return
·· 
RedirectToAction
·· '
(
··' (
nameof
··( .
(
··. /
Index
··/ 4
)
··4 5
)
··5 6
;
··6 7
}
‚‚ 
return
„„ 
View
„„ 
(
„„ 
empresas
„„  
)
„„  !
;
„„! "
}
‰‰ 	
[
ÁÁ 	
	Authorize
ÁÁ	 
(
ÁÁ 
Roles
ÁÁ 
=
ÁÁ 
$str
ÁÁ *
)
ÁÁ* +
]
ÁÁ+ ,
public
ËË 
async
ËË 
Task
ËË 
<
ËË 
IActionResult
ËË '
>
ËË' (
Delete
ËË) /
(
ËË/ 0
int
ËË0 3
?
ËË3 4
id
ËË5 7
)
ËË7 8
{
ÈÈ 	
if
ÍÍ 
(
ÍÍ 
id
ÍÍ 
==
ÍÍ 
null
ÍÍ 
||
ÍÍ 
_context
ÍÍ &
.
ÍÍ& '
Empresas
ÍÍ' /
==
ÍÍ0 2
null
ÍÍ3 7
)
ÍÍ7 8
{
ÎÎ 
return
ÏÏ 
NotFound
ÏÏ 
(
ÏÏ  
)
ÏÏ  !
;
ÏÏ! "
}
ÌÌ 
var
ÔÔ 
empresas
ÔÔ 
=
ÔÔ 
await
ÔÔ  
_context
ÔÔ! )
.
ÔÔ) *
Empresas
ÔÔ* 2
.
 !
FirstOrDefaultAsync
 $
(
$ %
m
% &
=>
' )
m
* +
.
+ ,

id_empresa
, 6
==
7 9
id
: <
)
< =
;
= >
if
ÒÒ 
(
ÒÒ 
empresas
ÒÒ 
==
ÒÒ 
null
ÒÒ  
)
ÒÒ  !
{
ÚÚ 
return
ÛÛ 
NotFound
ÛÛ 
(
ÛÛ  
)
ÛÛ  !
;
ÛÛ! "
}
ÙÙ 
return
ˆˆ 
View
ˆˆ 
(
ˆˆ 
empresas
ˆˆ  
)
ˆˆ  !
;
ˆˆ! "
}
˜˜ 	
[
˙˙ 	
HttpPost
˙˙	 
,
˙˙ 

ActionName
˙˙ 
(
˙˙ 
$str
˙˙ &
)
˙˙& '
]
˙˙' (
[
˚˚ 	&
ValidateAntiForgeryToken
˚˚	 !
]
˚˚! "
public
¸¸ 
async
¸¸ 
Task
¸¸ 
<
¸¸ 
IActionResult
¸¸ '
>
¸¸' (
DeleteConfirmed
¸¸) 8
(
¸¸8 9
int
¸¸9 <
id
¸¸= ?
)
¸¸? @
{
˝˝ 	
if
˛˛ 
(
˛˛ 
_context
˛˛ 
.
˛˛ 
Empresas
˛˛ !
==
˛˛" $
null
˛˛% )
)
˛˛) *
{
ˇˇ 
return
ÄÄ 
Problem
ÄÄ 
(
ÄÄ 
$str
ÄÄ M
)
ÄÄM N
;
ÄÄN O
}
ÅÅ 
var
ÇÇ 
empresas
ÇÇ 
=
ÇÇ 
await
ÇÇ  
_context
ÇÇ! )
.
ÇÇ) *
Empresas
ÇÇ* 2
.
ÇÇ2 3
	FindAsync
ÇÇ3 <
(
ÇÇ< =
id
ÇÇ= ?
)
ÇÇ? @
;
ÇÇ@ A
if
ÉÉ 
(
ÉÉ 
empresas
ÉÉ 
!=
ÉÉ 
null
ÉÉ  
)
ÉÉ  !
{
ÑÑ 
_context
ÖÖ 
.
ÖÖ 
Empresas
ÖÖ !
.
ÖÖ! "
Remove
ÖÖ" (
(
ÖÖ( )
empresas
ÖÖ) 1
)
ÖÖ1 2
;
ÖÖ2 3
}
ÜÜ 
await
àà 
_context
àà 
.
àà 
SaveChangesAsync
àà +
(
àà+ ,
)
àà, -
;
àà- .
return
ââ 
RedirectToAction
ââ #
(
ââ# $
nameof
ââ$ *
(
ââ* +
Index
ââ+ 0
)
ââ0 1
)
ââ1 2
;
ââ2 3
}
ää 	
private
åå 
bool
åå 
EmpresasExists
åå #
(
åå# $
int
åå$ '
id
åå( *
)
åå* +
{
çç 	
return
éé 
(
éé 
_context
éé 
.
éé 
Empresas
éé %
?
éé% &
.
éé& '
Any
éé' *
(
éé* +
e
éé+ ,
=>
éé- /
e
éé0 1
.
éé1 2

id_empresa
éé2 <
==
éé= ?
id
éé@ B
)
ééB C
)
ééC D
.
ééD E
GetValueOrDefault
ééE V
(
ééV W
)
ééW X
;
ééX Y
}
èè 	
}
êê 
}ëë ˇ,
tC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Controllers\HomeController.cs
	namespace

 	"
WebCamposDeportivos_V1


  
.

  !
_2

! #
.

# $
Controllers

$ /
{ 
public 

class 
HomeController 
:  !

Controller" ,
{ 
private 
readonly 
ILogger  
<  !
HomeController! /
>/ 0
_logger1 8
;8 9
private 
readonly 
AppDbContext %
_context& .
;. /
public 
HomeController 
( 
ILogger %
<% &
HomeController& 4
>4 5
logger6 <
,< =
AppDbContext> J
contextK R
)R S
{ 	
_logger 
= 
logger 
; 
_context 
= 
context 
; 
} 	
public 
IActionResult 
	Principal &
(& '
)' (
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
	Authorize	 
( 
Roles 
= 
$str ?
)? @
]@ A
public 
async 
Task 
< 
IActionResult '
>' ( 
DisponibilidadCampos) =
(= >
string> D
	searchEmpE N
,N O
TimeSpanP X

horaInicioY c
,c d
TimeSpane m
	horaFinaln w
)w x
{ 	
var 
query 
= 
_context  
.  !
Canchas! (
.   
Include   
(   
c   
=>   
c   
.    
Empresa    '
)  ' (
.!! 
AsQueryable!! 
(!! 
)!! 
;!! 
if## 
(## 
!## 
string## 
.## 
IsNullOrEmpty## %
(##% &
	searchEmp##& /
)##/ 0
)##0 1
{$$ 
query%% 
=%% 
query%% 
.%% 
Where%% #
(%%# $
c%%$ %
=>%%& (
c%%) *
.%%* +
Empresa%%+ 2
.%%2 3

id_empresa%%3 =
.%%= >
ToString%%> F
(%%F G
)%%G H
.%%H I
Contains%%I Q
(%%Q R
	searchEmp%%R [
)%%[ \
)%%\ ]
;%%] ^
}&& 
if(( 
((( 

horaInicio(( 
!=(( 
TimeSpan(( &
.((& '
Zero((' +
||((, .
	horaFinal((/ 8
!=((9 ;
TimeSpan((< D
.((D E
Zero((E I
||((J L

horaInicio((M W
!=((X Z
	horaFinal(([ d
)((d e
{)) 
query** 
=** 
query** 
.** 
Where** #
(**# $
c**$ %
=>**& (
c**) *
.*** +
Empresa**+ 2
.**2 3
horaApertura**3 ?
<=**@ B

horaInicio**C M
&&**N P
	horaFinal**Q Z
<=**[ ]
c**^ _
.**_ `
Empresa**` g
.**g h

horaCierre**h r
)**r s
;**s t
}++ 
var-- 
canchas-- 
=-- 
await-- 
query--  %
.--% &
ToListAsync--& 1
(--1 2
)--2 3
;--3 4
ViewData// 
[// 
$str// !
]//! "
=//# $
new//% (

SelectList//) 3
(//3 4
_context//4 <
.//< =
Empresas//= E
,//E F
$str//G S
,//S T
$str//U ]
)//] ^
;//^ _
return11 
View11 
(11 
canchas11 
)11  
;11  !
}22 	
[44 	
	Authorize44	 
(44 
Roles44 
=44 
$str44 ?
)44? @
]44@ A
public55 
IActionResult55 
Index55 "
(55" #
)55# $
{66 	
return77 
View77 
(77 
)77 
;77 
}88 	
public:: 
IActionResult:: 
TerminosCondiciones:: 0
(::0 1
)::1 2
{;; 	
return<< 
View<< 
(<< 
)<< 
;<< 
}== 	
public?? 
IActionResult?? 
Privacy?? $
(??$ %
)??% &
{@@ 	
returnAA 
ViewAA 
(AA 
)AA 
;AA 
}BB 	
[DD 	
ResponseCacheDD	 
(DD 
DurationDD 
=DD  !
$numDD" #
,DD# $
LocationDD% -
=DD. /!
ResponseCacheLocationDD0 E
.DDE F
NoneDDF J
,DDJ K
NoStoreDDL S
=DDT U
trueDDV Z
)DDZ [
]DD[ \
publicEE 
IActionResultEE 
ErrorEE "
(EE" #
)EE# $
{FF 	
returnGG 
ViewGG 
(GG 
newGG 
ErrorViewModelGG *
{GG+ ,
	RequestIdGG- 6
=GG7 8
ActivityGG9 A
.GGA B
CurrentGGB I
?GGI J
.GGJ K
IdGGK M
??GGN P
HttpContextGGQ \
.GG\ ]
TraceIdentifierGG] l
}GGm n
)GGn o
;GGo p
}HH 	
}II 
}JJ ™t
zC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Controllers\MediosPagoController.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $
Controllers$ /
{ 
public 

class  
MediosPagoController %
:& '

Controller( 2
{ 
private 
readonly 
AppDbContext %
_context& .
;. /
public  
MediosPagoController #
(# $
AppDbContext$ 0
context1 8
)8 9
{ 	
_context 
= 
context 
; 
} 	
public 
async 
Task 
< 
IActionResult '
>' (
Index) .
(. /
)/ 0
{ 	
var 
userId 
= 
User 
. 
FindFirstValue ,
(, -

ClaimTypes- 7
.7 8
NameIdentifier8 F
)F G
;G H
var 
empresas_usuario  
=! "
_context# +
.+ ,
User_Empresa, 8
. 
Where 
( 
ue 
=> 
ue 
.  

id_usuario  *
==+ -
int. 1
.1 2
Parse2 7
(7 8
userId8 >
)> ?
)? @
. 
Select 
( 
ue 
=> 
ue  
.  !
Empresa! (
)( )
.   
ToList   
(   
)   
;   
var"" 
pagosUsuario"" 
="" 
new"" "
List""# '
<""' (

MediosPago""( 2
>""2 3
(""3 4
)""4 5
;""5 6
foreach$$ 
($$ 
var$$ 
empresa$$  
in$$! #
empresas_usuario$$$ 4
)$$4 5
{%% 
var&& 
pagos&& 
=&& 
await&& !
_context&&" *
.&&* +
Pagos&&+ 0
.'' 
Where'' 
('' 
c'' 
=>'' 
c''  !
.''! "

id_empresa''" ,
==''- /
empresa''0 7
.''7 8

id_empresa''8 B
)''B C
.(( 
ToListAsync((  
(((  !
)((! "
;((" #
pagosUsuario** 
.** 
AddRange** %
(**% &
pagos**& +
)**+ ,
;**, -
}++ 
return-- 
View-- 
(-- 
pagosUsuario-- $
)--$ %
;--% &
}.. 	
public11 
async11 
Task11 
<11 
IActionResult11 '
>11' (
Details11) 0
(110 1
int111 4
?114 5
id116 8
)118 9
{22 	
if33 
(33 
id33 
==33 
null33 
||33 
_context33 &
.33& '
Pagos33' ,
==33- /
null330 4
)334 5
{44 
return55 
NotFound55 
(55  
)55  !
;55! "
}66 
var88 

mediosPago88 
=88 
await88 "
_context88# +
.88+ ,
Pagos88, 1
.99 
Include99 
(99 
m99 
=>99 
m99 
.99  
Empresas99  (
)99( )
.:: 
FirstOrDefaultAsync:: $
(::$ %
m::% &
=>::' )
m::* +
.::+ ,
id_pagos::, 4
==::5 7
id::8 :
)::: ;
;::; <
if;; 
(;; 

mediosPago;; 
==;; 
null;; "
);;" #
{<< 
return== 
NotFound== 
(==  
)==  !
;==! "
}>> 
return@@ 
View@@ 
(@@ 

mediosPago@@ "
)@@" #
;@@# $
}AA 	
publicDD 
IActionResultDD 
CreateDD #
(DD# $
)DD$ %
{EE 	
varFF 
userIdFF 
=FF 
UserFF 
.FF 
FindFirstValueFF ,
(FF, -

ClaimTypesFF- 7
.FF7 8
NameIdentifierFF8 F
)FFF G
;FFG H
varHH 
empresas_usuarioHH  
=HH! "
_contextHH# +
.HH+ ,
User_EmpresaHH, 8
.II 
WhereII 
(II 
ueII 
=>II 
ueII 
.II  

id_usuarioII  *
==II+ -
intII. 1
.II1 2
ParseII2 7
(II7 8
userIdII8 >
)II> ?
)II? @
.JJ 
SelectJJ 
(JJ 
ueJJ 
=>JJ 
ueJJ  
.JJ  !
EmpresaJJ! (
)JJ( )
.KK 
ToListKK 
(KK 
)KK 
;KK 
ViewDataMM 
[MM 
$strMM !
]MM! "
=MM# $
newMM% (

SelectListMM) 3
(MM3 4
empresas_usuarioMM4 D
,MMD E
$strMMF R
,MMR S
$strMMT \
)MM\ ]
;MM] ^
returnNN 
ViewNN 
(NN 
)NN 
;NN 
}OO 	
[TT 	
HttpPostTT	 
]TT 
[UU 	$
ValidateAntiForgeryTokenUU	 !
]UU! "
publicVV 
asyncVV 
TaskVV 
<VV 
IActionResultVV '
>VV' (
CreateVV) /
(VV/ 0
[VV0 1
BindVV1 5
(VV5 6
$strVV6 ^
)VV^ _
]VV_ `

MediosPagoVVa k

mediosPagoVVl v
)VVv w
{WW 	
ifXX 
(XX 

ModelStateXX 
.XX 
IsValidXX "
)XX" #
{YY 
_contextZZ 
.ZZ 
AddZZ 
(ZZ 

mediosPagoZZ '
)ZZ' (
;ZZ( )
await[[ 
_context[[ 
.[[ 
SaveChangesAsync[[ /
([[/ 0
)[[0 1
;[[1 2
return\\ 
RedirectToAction\\ '
(\\' (
nameof\\( .
(\\. /
Index\\/ 4
)\\4 5
)\\5 6
;\\6 7
}]] 
ViewData^^ 
[^^ 
$str^^ !
]^^! "
=^^# $
new^^% (

SelectList^^) 3
(^^3 4
_context^^4 <
.^^< =
Empresas^^= E
,^^E F
$str^^G S
,^^S T
$str^^U ]
,^^] ^

mediosPago^^_ i
.^^i j

id_empresa^^j t
)^^t u
;^^u v
return__ 
View__ 
(__ 

mediosPago__ "
)__" #
;__# $
}`` 	
publiccc 
asynccc 
Taskcc 
<cc 
IActionResultcc '
>cc' (
Editcc) -
(cc- .
intcc. 1
?cc1 2
idcc3 5
)cc5 6
{dd 	
ifee 
(ee 
idee 
==ee 
nullee 
||ee 
_contextee &
.ee& '
Pagosee' ,
==ee- /
nullee0 4
)ee4 5
{ff 
returngg 
NotFoundgg 
(gg  
)gg  !
;gg! "
}hh 
varjj 

mediosPagojj 
=jj 
awaitjj "
_contextjj# +
.jj+ ,
Pagosjj, 1
.jj1 2
	FindAsyncjj2 ;
(jj; <
idjj< >
)jj> ?
;jj? @
ifkk 
(kk 

mediosPagokk 
==kk 
nullkk "
)kk" #
{ll 
returnmm 
NotFoundmm 
(mm  
)mm  !
;mm! "
}nn 
ViewDataoo 
[oo 
$stroo !
]oo! "
=oo# $
newoo% (

SelectListoo) 3
(oo3 4
_contextoo4 <
.oo< =
Empresasoo= E
,ooE F
$strooG S
,ooS T
$strooU ]
,oo] ^

mediosPagooo_ i
.ooi j

id_empresaooj t
)oot u
;oou v
returnpp 
Viewpp 
(pp 

mediosPagopp "
)pp" #
;pp# $
}qq 	
[vv 	
HttpPostvv	 
]vv 
[ww 	$
ValidateAntiForgeryTokenww	 !
]ww! "
publicxx 
asyncxx 
Taskxx 
<xx 
IActionResultxx '
>xx' (
Editxx) -
(xx- .
intxx. 1
idxx2 4
,xx4 5
[xx6 7
Bindxx7 ;
(xx; <
$strxx< d
)xxd e
]xxe f

MediosPagoxxg q

mediosPagoxxr |
)xx| }
{yy 	
ifzz 
(zz 
idzz 
!=zz 

mediosPagozz  
.zz  !
id_pagoszz! )
)zz) *
{{{ 
return|| 
NotFound|| 
(||  
)||  !
;||! "
}}} 
if 
( 

ModelState 
. 
IsValid "
)" #
{
ÄÄ 
try
ÅÅ 
{
ÇÇ 
_context
ÉÉ 
.
ÉÉ 
Update
ÉÉ #
(
ÉÉ# $

mediosPago
ÉÉ$ .
)
ÉÉ. /
;
ÉÉ/ 0
await
ÑÑ 
_context
ÑÑ "
.
ÑÑ" #
SaveChangesAsync
ÑÑ# 3
(
ÑÑ3 4
)
ÑÑ4 5
;
ÑÑ5 6
}
ÖÖ 
catch
ÜÜ 
(
ÜÜ *
DbUpdateConcurrencyException
ÜÜ 3
)
ÜÜ3 4
{
áá 
if
àà 
(
àà 
!
àà 
MediosPagoExists
àà )
(
àà) *

mediosPago
àà* 4
.
àà4 5
id_pagos
àà5 =
)
àà= >
)
àà> ?
{
ââ 
return
ää 
NotFound
ää '
(
ää' (
)
ää( )
;
ää) *
}
ãã 
else
åå 
{
çç 
throw
éé 
;
éé 
}
èè 
}
êê 
return
ëë 
RedirectToAction
ëë '
(
ëë' (
nameof
ëë( .
(
ëë. /
Index
ëë/ 4
)
ëë4 5
)
ëë5 6
;
ëë6 7
}
íí 
ViewData
ìì 
[
ìì 
$str
ìì !
]
ìì! "
=
ìì# $
new
ìì% (

SelectList
ìì) 3
(
ìì3 4
_context
ìì4 <
.
ìì< =
Empresas
ìì= E
,
ììE F
$str
ììG S
,
ììS T
$str
ììU ]
,
ìì] ^

mediosPago
ìì_ i
.
ììi j

id_empresa
ììj t
)
ììt u
;
ììu v
return
îî 
View
îî 
(
îî 

mediosPago
îî "
)
îî" #
;
îî# $
}
ïï 	
public
òò 
async
òò 
Task
òò 
<
òò 
IActionResult
òò '
>
òò' (
Delete
òò) /
(
òò/ 0
int
òò0 3
?
òò3 4
id
òò5 7
)
òò7 8
{
ôô 	
if
öö 
(
öö 
id
öö 
==
öö 
null
öö 
||
öö 
_context
öö &
.
öö& '
Pagos
öö' ,
==
öö- /
null
öö0 4
)
öö4 5
{
õõ 
return
úú 
NotFound
úú 
(
úú  
)
úú  !
;
úú! "
}
ùù 
var
üü 

mediosPago
üü 
=
üü 
await
üü "
_context
üü# +
.
üü+ ,
Pagos
üü, 1
.
†† 
Include
†† 
(
†† 
m
†† 
=>
†† 
m
†† 
.
††  
Empresas
††  (
)
††( )
.
°° !
FirstOrDefaultAsync
°° $
(
°°$ %
m
°°% &
=>
°°' )
m
°°* +
.
°°+ ,
id_pagos
°°, 4
==
°°5 7
id
°°8 :
)
°°: ;
;
°°; <
if
¢¢ 
(
¢¢ 

mediosPago
¢¢ 
==
¢¢ 
null
¢¢ "
)
¢¢" #
{
££ 
return
§§ 
NotFound
§§ 
(
§§  
)
§§  !
;
§§! "
}
•• 
return
ßß 
View
ßß 
(
ßß 

mediosPago
ßß "
)
ßß" #
;
ßß# $
}
®® 	
[
´´ 	
HttpPost
´´	 
,
´´ 

ActionName
´´ 
(
´´ 
$str
´´ &
)
´´& '
]
´´' (
[
¨¨ 	&
ValidateAntiForgeryToken
¨¨	 !
]
¨¨! "
public
≠≠ 
async
≠≠ 
Task
≠≠ 
<
≠≠ 
IActionResult
≠≠ '
>
≠≠' (
DeleteConfirmed
≠≠) 8
(
≠≠8 9
int
≠≠9 <
id
≠≠= ?
)
≠≠? @
{
ÆÆ 	
if
ØØ 
(
ØØ 
_context
ØØ 
.
ØØ 
Pagos
ØØ 
==
ØØ !
null
ØØ" &
)
ØØ& '
{
∞∞ 
return
±± 
Problem
±± 
(
±± 
$str
±± J
)
±±J K
;
±±K L
}
≤≤ 
var
≥≥ 

mediosPago
≥≥ 
=
≥≥ 
await
≥≥ "
_context
≥≥# +
.
≥≥+ ,
Pagos
≥≥, 1
.
≥≥1 2
	FindAsync
≥≥2 ;
(
≥≥; <
id
≥≥< >
)
≥≥> ?
;
≥≥? @
if
¥¥ 
(
¥¥ 

mediosPago
¥¥ 
!=
¥¥ 
null
¥¥ "
)
¥¥" #
{
µµ 
_context
∂∂ 
.
∂∂ 
Pagos
∂∂ 
.
∂∂ 
Remove
∂∂ %
(
∂∂% &

mediosPago
∂∂& 0
)
∂∂0 1
;
∂∂1 2
}
∑∑ 
await
ππ 
_context
ππ 
.
ππ 
SaveChangesAsync
ππ +
(
ππ+ ,
)
ππ, -
;
ππ- .
return
∫∫ 
RedirectToAction
∫∫ #
(
∫∫# $
nameof
∫∫$ *
(
∫∫* +
Index
∫∫+ 0
)
∫∫0 1
)
∫∫1 2
;
∫∫2 3
}
ªª 	
private
ΩΩ 
bool
ΩΩ 
MediosPagoExists
ΩΩ %
(
ΩΩ% &
int
ΩΩ& )
id
ΩΩ* ,
)
ΩΩ, -
{
ææ 	
return
øø 
(
øø 
_context
øø 
.
øø 
Pagos
øø "
?
øø" #
.
øø# $
Any
øø$ '
(
øø' (
e
øø( )
=>
øø* ,
e
øø- .
.
øø. /
id_pagos
øø/ 7
==
øø8 :
id
øø; =
)
øø= >
)
øø> ?
.
øø? @
GetValueOrDefault
øø@ Q
(
øøQ R
)
øøR S
;
øøS T
}
¿¿ 	
}
¡¡ 
}¬¬ îß
xC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Controllers\ReservasController.cs
	namespace		 	"
WebCamposDeportivos_V1		
  
.		  !
_2		! #
.		# $
Controllers		$ /
{

 
public 

class 
ReservasController #
:$ %

Controller& 0
{ 
private 
readonly 
AppDbContext %
_context& .
;. /
public 
ReservasController !
(! "
AppDbContext" .
context/ 6
)6 7
{ 	
_context 
= 
context 
; 
} 	
[ 	
	Authorize	 
( 
Roles 
= 
$str ?
)? @
]@ A
public 
async 
Task 
< 
IActionResult '
>' (
Index) .
(. /
string/ 5

searchName6 @
)@ A
{ 	
var 
userID 
= 
User 
. 
FindFirstValue ,
(, -

ClaimTypes- 7
.7 8
NameIdentifier8 F
)F G
;G H
var 
query 
= 
_context  
.  !
Reservas! )
. 
Include 
( 
u 
=> 
u 
.  
Cliente  '
)' (
. 
Include 
( 
c 
=> 
c 
.  
Campo  %
)% &
. 
Include 
( 
emp 
=> 
emp  #
.# $
Campo$ )
.) *
Empresa* 1
)1 2
. 
AsQueryable 
( 
) 
; 
if   
(   
User   
.   
IsInRole   
(   
$str   '
)  ' (
&&  ) +
userID  , 2
!=  3 5
null  6 :
)  : ;
{!! 
query"" 
="" 
query"" 
."" 
Where"" #
(""# $
r""$ %
=>""& (
r"") *
.""* +
	ClienteID""+ 4
==""5 7
Convert""8 ?
.""? @
ToInt32""@ G
(""G H
userID""H N
)""N O
)""O P
;""P Q
if$$ 
($$ 
!$$ 
string$$ 
.$$ 
IsNullOrEmpty$$ )
($$) *

searchName$$* 4
)$$4 5
)$$5 6
{%% 
query&& 
=&& 
query&& !
.&&! "
Where&&" '
(&&' (
r&&( )
=>&&* ,
r&&- .
.&&. /
fechaReserva&&/ ;
.&&; <
ToString&&< D
(&&D E
)&&E F
.&&F G
Contains&&G O
(&&O P

searchName&&P Z
)&&Z [
)&&[ \
;&&\ ]
}'' 
}(( 
else** 
if** 
(** 
User** 
.** 
IsInRole** "
(**" #
$str**# 2
)**2 3
||**4 6
User**7 ;
.**; <
IsInRole**< D
(**D E
$str**E Q
)**Q R
)**R S
{++ 
if,, 
(,, 
!,, 
string,, 
.,, 
IsNullOrEmpty,, )
(,,) *

searchName,,* 4
),,4 5
),,5 6
{-- 
query.. 
=.. 
query.. !
...! "
Where.." '
(..' (
r..( )
=>..* ,
r..- .
.... /
fechaReserva../ ;
...; <
ToString..< D
(..D E
)..E F
...F G
Contains..G O
(..O P

searchName..P Z
)..Z [
)..[ \
;..\ ]
}// 
}00 
else22 
{33 
return44 
Forbid44 
(44 
)44 
;44  
}55 
var77 
reservas77 
=77 
await77  
query77! &
.77& '
ToListAsync77' 2
(772 3
)773 4
;774 5
return99 
View99 
(99 
reservas99  
)99  !
;99! "
}:: 	
[== 	
	Authorize==	 
(== 
Roles== 
=== 
$str== 3
)==3 4
]==4 5
public?? 
async?? 
Task?? 
<?? 
IActionResult?? '
>??' (
Details??) 0
(??0 1
int??1 4
???4 5
id??6 8
)??8 9
{@@ 	
ifAA 
(AA 
idAA 
==AA 
nullAA 
||AA 
_contextAA &
.AA& '
ReservasAA' /
==AA0 2
nullAA3 7
)AA7 8
{BB 
returnCC 
NotFoundCC 
(CC  
)CC  !
;CC! "
}DD 
varFF 
reservasFF 
=FF 
awaitFF  
_contextFF! )
.FF) *
ReservasFF* 2
.GG 
IncludeGG 
(GG 
uGG 
=>GG 
uGG 
.GG  
ClienteGG  '
)GG' (
.HH 
IncludeHH 
(HH 
tHH 
=>HH 
tHH 
.HH  
CampoHH  %
)HH% &
.II 
IncludeII 
(II 
rII 
=>II 
rII 
.II  
CampoII  %
.II% &
EmpresaII& -
)II- .
.JJ 

FirstAsyncJJ 
(JJ 
mJJ 
=>JJ  
mJJ! "
.JJ" #

id_reservaJJ# -
==JJ. 0
idJJ1 3
)JJ3 4
;JJ4 5
ifKK 
(KK 
reservasKK 
==KK 
nullKK  
)KK  !
{LL 
returnMM 
NotFoundMM 
(MM  
)MM  !
;MM! "
}NN 
returnPP 
ViewPP 
(PP 
reservasPP  
)PP  !
;PP! "
}QQ 	
[TT 	
	AuthorizeTT	 
(TT 
RolesTT 
=TT 
$strTT $
)TT$ %
]TT% &
publicUU 
asyncUU 
TaskUU 
<UU 
IActionResultUU '
>UU' (
CreateUU) /
(UU/ 0
intUU0 3
idCanchaUU4 <
,UU< =
stringUU> D
horaSeleccionadaUUE U
,UUU V
ReservasUUW _
reservasUU` h
)UUh i
{VV 	
varWW 
userIdWW 
=WW 
UserWW 
.WW 
FindFirstValueWW ,
(WW, -

ClaimTypesWW- 7
.WW7 8
NameIdentifierWW8 F
)WWF G
;WWG H
varYY 
clienteUsuarioYY 
=YY  
_contextYY! )
.YY) *
UsuariosYY* 2
.ZZ 
FirstZZ 
(ZZ 
ueZZ 
=>ZZ 
ueZZ 
.ZZ  

id_usuarioZZ  *
==ZZ+ -
intZZ. 1
.ZZ1 2
ParseZZ2 7
(ZZ7 8
userIdZZ8 >
)ZZ> ?
)ZZ? @
;ZZ@ A
ViewBag\\ 
.\\ 
	IdCliente\\ 
=\\ 
$"\\  "
{\\" #
clienteUsuario\\# 1
.\\1 2

id_usuario\\2 <
}\\< =
"\\= >
;\\> ?
ViewBag]] 
.]] 
nombreCliente]] !
=]]" #
$"]]$ &
{]]& '
clienteUsuario]]' 5
.]]5 6
nombres]]6 =
}]]= >
"]]> ?
;]]? @
var__ 
cancha__ 
=__ 
await__ 
_context__ '
.__' (
Canchas__( /
.`` 
Include`` 
(`` 
c`` 
=>`` !
c``" #
.``# $
Empresa``$ +
)``+ ,
.aa 
FirstOrDefaultAsyncaa (
(aa( )
caa) *
=>aa+ -
caa. /
.aa/ 0
	id_canchaaa0 9
==aa: <
idCanchaaa= E
)aaE F
;aaF G
ifcc 
(cc 
canchacc 
==cc 
nullcc 
)cc 
{dd 
returnee 
NotFoundee 
(ee  
)ee  !
;ee! "
}ff 
decimalii 
costoii 
=ii 
reservasii $
.ii$ %
ObtenerCostoHoraii% 5
(ii5 6
TimeSpanii6 >
.ii> ?
Parseii? D
(iiD E
horaSeleccionadaiiE U
)iiU V
,iiV W
canchaiiX ^
)ii^ _
;ii_ `
ViewBagkk 
.kk 
IdCanchakk 
=kk 
$"kk !
{kk! "
canchakk" (
.kk( )
	id_canchakk) 2
}kk2 3
"kk3 4
;kk4 5
ViewBagll 
.ll 
NombreEmpresall !
=ll" #
$"ll$ &
{ll& '
canchall' -
.ll- .
Empresall. 5
.ll5 6
nombrell6 <
}ll< =
"ll= >
;ll> ?
ViewBagmm 
.mm 
deporteCampomm  
=mm! "
$"mm# %
{mm% &
canchamm& ,
.mm, -
deportemm- 4
}mm4 5
"mm5 6
;mm6 7
ViewBagoo 
.oo 
	costoHoraoo 
=oo 
$"oo  "
{oo" #
costooo# (
}oo( )
"oo) *
;oo* +
ViewBagqq 
.qq 
HoraSeleccionadaqq $
=qq% &
horaSeleccionadaqq' 7
;qq7 8
returnss 
Viewss 
(ss 
newss 
Reservasss $
{ss% &
fechaReservass' 3
=ss4 5
DateTimess6 >
.ss> ?
Nowss? B
}ssC D
)ssD E
;ssE F
}uu 	
[zz 	
HttpPostzz	 
]zz 
[{{ 	$
ValidateAntiForgeryToken{{	 !
]{{! "
public|| 
async|| 
Task|| 
<|| 
IActionResult|| '
>||' (
Create||) /
(||/ 0
Reservas||0 8
reservas||9 A
,||A B
int||C F
idCancha||G O
)||O P
{}} 	
if~~ 
(~~ 

ModelState~~ 
.~~ 
IsValid~~ "
)~~" #
{ 
var
ÅÅ 
userID
ÅÅ 
=
ÅÅ 
User
ÅÅ !
.
ÅÅ! "
FindFirstValue
ÅÅ" 0
(
ÅÅ0 1

ClaimTypes
ÅÅ1 ;
.
ÅÅ; <
NameIdentifier
ÅÅ< J
)
ÅÅJ K
;
ÅÅK L
if
ÑÑ 
(
ÑÑ 
userID
ÑÑ 
!=
ÑÑ 
null
ÑÑ "
)
ÑÑ" #
{
ÖÖ 
reservas
áá 
.
áá 
	ClienteID
áá &
=
áá' (
int
áá) ,
.
áá, -
Parse
áá- 2
(
áá2 3
userID
áá3 9
)
áá9 :
;
áá: ;
reservas
ää 
.
ää 
estado
ää #
=
ää$ %
$str
ää& 1
;
ää1 2
reservas
ãã 
.
ãã 
CampoID
ãã $
=
ãã% &
idCancha
ãã' /
;
ãã/ 0
var
éé 
ReservaExistente
éé (
=
éé) *
await
éé+ 0
_context
éé1 9
.
éé9 :
Reservas
éé: B
.
èè !
FirstOrDefaultAsync
èè 0
(
èè0 1
r
èè1 2
=>
èè3 5
r
èè6 7
.
èè7 8
CampoID
èè8 ?
==
èè@ B
reservas
èèC K
.
èèK L
CampoID
èèL S
&&
èèT V
r
êê1 2
.
êê2 3
fechaReserva
êê3 ?
.
êê? @
Date
êê@ D
==
êêE G
reservas
êêH P
.
êêP Q
fechaReserva
êêQ ]
.
êê] ^
Date
êê^ b
&&
êêc e
r
ëë1 2
.
ëë2 3
horaReserva
ëë3 >
.
ëë> ?
Hours
ëë? D
==
ëëE G
reservas
ëëH P
.
ëëP Q
horaReserva
ëëQ \
.
ëë\ ]
Hours
ëë] b
&&
ëëc e
r
íí1 2
.
íí2 3
horaReserva
íí3 >
.
íí> ?
Minutes
íí? F
==
ííG I
reservas
ííJ R
.
ííR S
horaReserva
ííS ^
.
íí^ _
Minutes
íí_ f
)
ííf g
;
ííg h
if
îî 
(
îî 
ReservaExistente
îî (
!=
îî) +
null
îî, 0
)
îî0 1
{
ïï 

ModelState
óó "
.
óó" #
AddModelError
óó# 0
(
óó0 1
string
óó1 7
.
óó7 8
Empty
óó8 =
,
óó= >
$str
óó? s
)
óós t
;
óót u
var
öö 
clienteUsuario
öö *
=
öö+ ,
_context
öö- 5
.
öö5 6
Usuarios
öö6 >
.
õõ 
FirstOrDefault
õõ +
(
õõ+ ,
ue
õõ, .
=>
õõ/ 1
ue
õõ2 4
.
õõ4 5

id_usuario
õõ5 ?
==
õõ@ B
int
õõC F
.
õõF G
Parse
õõG L
(
õõL M
userID
õõM S
)
õõS T
)
õõT U
;
õõU V
ViewBag
ùù 
.
ùù  
	IdCliente
ùù  )
=
ùù* +
$"
ùù, .
{
ùù. /
clienteUsuario
ùù/ =
.
ùù= >

id_usuario
ùù> H
}
ùùH I
"
ùùI J
;
ùùJ K
ViewBag
ûû 
.
ûû  
nombreCliente
ûû  -
=
ûû. /
$"
ûû0 2
{
ûû2 3
clienteUsuario
ûû3 A
.
ûûA B
nombres
ûûB I
}
ûûI J
"
ûûJ K
;
ûûK L
var
†† 
cancha
†† "
=
††# $
await
††% *
_context
††+ 3
.
††3 4
Canchas
††4 ;
.
°° 
Include
°° $
(
°°$ %
c
°°% &
=>
°°' )
c
°°* +
.
°°+ ,
Empresa
°°, 3
)
°°3 4
.
¢¢ !
FirstOrDefaultAsync
¢¢ 0
(
¢¢0 1
c
¢¢1 2
=>
¢¢3 5
c
¢¢6 7
.
¢¢7 8
	id_cancha
¢¢8 A
==
¢¢B D
idCancha
¢¢E M
)
¢¢M N
;
¢¢N O
if
§§ 
(
§§ 
cancha
§§ "
==
§§# %
null
§§& *
)
§§* +
{
•• 
return
¶¶ "
NotFound
¶¶# +
(
¶¶+ ,
)
¶¶, -
;
¶¶- .
}
ßß 
decimal
™™ 
costo
™™  %
=
™™& '
reservas
™™( 0
.
™™0 1
ObtenerCostoHora
™™1 A
(
™™A B
TimeSpan
™™B J
.
™™J K
Parse
™™K P
(
™™P Q
reservas
™™Q Y
.
™™Y Z
horaReserva
™™Z e
.
™™e f
ToString
™™f n
(
™™n o
)
™™o p
)
™™p q
,
™™q r
cancha
™™s y
)
™™y z
;
™™z {
ViewBag
¨¨ 
.
¨¨  
IdCancha
¨¨  (
=
¨¨) *
$"
¨¨+ -
{
¨¨- .
cancha
¨¨. 4
.
¨¨4 5
	id_cancha
¨¨5 >
}
¨¨> ?
"
¨¨? @
;
¨¨@ A
ViewBag
≠≠ 
.
≠≠  
NombreEmpresa
≠≠  -
=
≠≠. /
$"
≠≠0 2
{
≠≠2 3
cancha
≠≠3 9
.
≠≠9 :
Empresa
≠≠: A
.
≠≠A B
nombre
≠≠B H
}
≠≠H I
"
≠≠I J
;
≠≠J K
ViewBag
ÆÆ 
.
ÆÆ  
deporteCampo
ÆÆ  ,
=
ÆÆ- .
$"
ÆÆ/ 1
{
ÆÆ1 2
cancha
ÆÆ2 8
.
ÆÆ8 9
deporte
ÆÆ9 @
}
ÆÆ@ A
"
ÆÆA B
;
ÆÆB C
ViewBag
∞∞ 
.
∞∞  
	costoHora
∞∞  )
=
∞∞* +
$"
∞∞, .
{
∞∞. /
costo
∞∞/ 4
}
∞∞4 5
"
∞∞5 6
;
∞∞6 7
ViewBag
≤≤ 
.
≤≤  
HoraSeleccionada
≤≤  0
=
≤≤1 2
reservas
≤≤3 ;
.
≤≤; <
horaReserva
≤≤< G
.
≤≤G H
ToString
≤≤H P
(
≤≤P Q
)
≤≤Q R
;
≤≤R S
return
¥¥ 
View
¥¥ #
(
¥¥# $
reservas
¥¥$ ,
)
¥¥, -
;
¥¥- .
}
µµ 
var
∏∏ 
canchas
∏∏ 
=
∏∏  !
await
∏∏" '
_context
∏∏( 0
.
∏∏0 1
Canchas
∏∏1 8
.
ππ 
Include
ππ  
(
ππ  !
e
ππ! "
=>
ππ$ &
e
ππ' (
.
ππ( )
Empresa
ππ) 0
)
ππ0 1
.
∫∫ 

FirstAsync
∫∫ #
(
∫∫# $
c
∫∫$ %
=>
∫∫& (
c
∫∫) *
.
∫∫* +
	id_cancha
∫∫+ 4
==
∫∫5 7
idCancha
∫∫8 @
)
∫∫@ A
;
∫∫A B
var
ºº #
rangoHorasDisponibles
ºº -
=
ºº. /
canchas
ºº0 7
.
ºº7 8
Empresa
ºº8 ?
.
ºº? @*
ObtenerRangoHorasDisponibles
ºº@ \
(
ºº\ ]
)
ºº] ^
;
ºº^ _
var
ææ 
horaSeleccionada
ææ (
=
ææ) *
reservas
ææ+ 3
.
ææ3 4
horaReserva
ææ4 ?
;
ææ? @
var
øø 
numeroHoras
øø #
=
øø$ %
reservas
øø& .
.
øø. /
numeroHoras
øø/ :
;
øø: ;
var
¡¡ 
horasReservadas
¡¡ '
=
¡¡( )
new
¡¡* -
List
¡¡. 2
<
¡¡2 3
TimeSpan
¡¡3 ;
>
¡¡; <
(
¡¡< =
)
¡¡= >
;
¡¡> ?
for
√√ 
(
√√ 
int
√√ 
i
√√ 
=
√√  
$num
√√! "
;
√√" #
i
√√$ %
<
√√% &
numeroHoras
√√& 1
;
√√1 2
i
√√3 4
++
√√4 6
)
√√6 7
{
ƒƒ 
horasReservadas
≈≈ '
.
≈≈' (
Add
≈≈( +
(
≈≈+ ,
horaSeleccionada
≈≈, <
.
≈≈< =
Add
≈≈= @
(
≈≈@ A
TimeSpan
≈≈A I
.
≈≈I J
	FromHours
≈≈J S
(
≈≈S T
i
≈≈T U
)
≈≈U V
)
≈≈V W
)
≈≈W X
;
≈≈X Y
}
∆∆ 
if
»» 
(
»» 
horasReservadas
»» &
.
»»& '
Any
»»' *
(
»»* +
h
»»+ ,
=>
»»- /
!
»»0 1#
rangoHorasDisponibles
»»1 F
.
»»F G
Contains
»»G O
(
»»O P
h
»»P Q
)
»»Q R
)
»»R S
)
»»S T
{
…… 

ModelState
   "
.
  " #
AddModelError
  # 0
(
  0 1
string
  1 7
.
  7 8
Empty
  8 =
,
  = >
$str  ? ñ
)  ñ ó
;  ó ò
var
ÕÕ 
clienteUsuario
ÕÕ *
=
ÕÕ+ ,
_context
ÕÕ- 5
.
ÕÕ5 6
Usuarios
ÕÕ6 >
.
ŒŒ 
FirstOrDefault
ŒŒ +
(
ŒŒ+ ,
ue
ŒŒ, .
=>
ŒŒ/ 1
ue
ŒŒ2 4
.
ŒŒ4 5

id_usuario
ŒŒ5 ?
==
ŒŒ@ B
int
ŒŒC F
.
ŒŒF G
Parse
ŒŒG L
(
ŒŒL M
userID
ŒŒM S
)
ŒŒS T
)
ŒŒT U
;
ŒŒU V
ViewBag
–– 
.
––  
	IdCliente
––  )
=
––* +
$"
––, .
{
––. /
clienteUsuario
––/ =
.
––= >

id_usuario
––> H
}
––H I
"
––I J
;
––J K
ViewBag
—— 
.
——  
nombreCliente
——  -
=
——. /
$"
——0 2
{
——2 3
clienteUsuario
——3 A
.
——A B
nombres
——B I
}
——I J
"
——J K
;
——K L
var
”” 
cancha
”” "
=
””# $
await
””% *
_context
””+ 3
.
””3 4
Canchas
””4 ;
.
‘‘ 
Include
‘‘ $
(
‘‘$ %
c
‘‘% &
=>
‘‘' )
c
‘‘* +
.
‘‘+ ,
Empresa
‘‘, 3
)
‘‘3 4
.
’’ !
FirstOrDefaultAsync
’’ 0
(
’’0 1
c
’’1 2
=>
’’3 5
c
’’6 7
.
’’7 8
	id_cancha
’’8 A
==
’’B D
idCancha
’’E M
)
’’M N
;
’’N O
if
◊◊ 
(
◊◊ 
cancha
◊◊ "
==
◊◊# %
null
◊◊& *
)
◊◊* +
{
ÿÿ 
return
ŸŸ "
NotFound
ŸŸ# +
(
ŸŸ+ ,
)
ŸŸ, -
;
ŸŸ- .
}
⁄⁄ 
decimal
›› 
costo
››  %
=
››& '
reservas
››( 0
.
››0 1
ObtenerCostoHora
››1 A
(
››A B
TimeSpan
››B J
.
››J K
Parse
››K P
(
››P Q
reservas
››Q Y
.
››Y Z
horaReserva
››Z e
.
››e f
ToString
››f n
(
››n o
)
››o p
)
››p q
,
››q r
cancha
››s y
)
››y z
;
››z {
ViewBag
ﬂﬂ 
.
ﬂﬂ  
IdCancha
ﬂﬂ  (
=
ﬂﬂ) *
$"
ﬂﬂ+ -
{
ﬂﬂ- .
cancha
ﬂﬂ. 4
.
ﬂﬂ4 5
	id_cancha
ﬂﬂ5 >
}
ﬂﬂ> ?
"
ﬂﬂ? @
;
ﬂﬂ@ A
ViewBag
‡‡ 
.
‡‡  
NombreEmpresa
‡‡  -
=
‡‡. /
$"
‡‡0 2
{
‡‡2 3
cancha
‡‡3 9
.
‡‡9 :
Empresa
‡‡: A
.
‡‡A B
nombre
‡‡B H
}
‡‡H I
"
‡‡I J
;
‡‡J K
ViewBag
·· 
.
··  
deporteCampo
··  ,
=
··- .
$"
··/ 1
{
··1 2
cancha
··2 8
.
··8 9
deporte
··9 @
}
··@ A
"
··A B
;
··B C
ViewBag
„„ 
.
„„  
	costoHora
„„  )
=
„„* +
$"
„„, .
{
„„. /
costo
„„/ 4
}
„„4 5
"
„„5 6
;
„„6 7
ViewBag
ÂÂ 
.
ÂÂ  
HoraSeleccionada
ÂÂ  0
=
ÂÂ1 2
reservas
ÂÂ3 ;
.
ÂÂ; <
horaReserva
ÂÂ< G
.
ÂÂG H
ToString
ÂÂH P
(
ÂÂP Q
)
ÂÂQ R
;
ÂÂR S
return
ÁÁ 
View
ÁÁ #
(
ÁÁ# $
reservas
ÁÁ$ ,
)
ÁÁ, -
;
ÁÁ- .
}
ËË 
_context
ÎÎ 
.
ÎÎ 
Add
ÎÎ  
(
ÎÎ  !
reservas
ÎÎ! )
)
ÎÎ) *
;
ÎÎ* +
await
ÏÏ 
_context
ÏÏ "
.
ÏÏ" #
SaveChangesAsync
ÏÏ# 3
(
ÏÏ3 4
)
ÏÏ4 5
;
ÏÏ5 6
return
ÓÓ 
RedirectToAction
ÓÓ +
(
ÓÓ+ ,
nameof
ÓÓ, 2
(
ÓÓ2 3
Index
ÓÓ3 8
)
ÓÓ8 9
)
ÓÓ9 :
;
ÓÓ: ;
}
ÔÔ 
else
 
{
ÒÒ 
return
ÛÛ 
Forbid
ÛÛ !
(
ÛÛ! "
)
ÛÛ" #
;
ÛÛ# $
}
ÙÙ 
}
ıı 
return
˜˜ 
View
˜˜ 
(
˜˜ 
reservas
˜˜  
)
˜˜  !
;
˜˜! "
}
¯¯ 	
[
˚˚ 	
	Authorize
˚˚	 
(
˚˚ 
Roles
˚˚ 
=
˚˚ 
$str
˚˚ $
)
˚˚$ %
]
˚˚% &
public
¸¸ 
async
¸¸ 
Task
¸¸ 
<
¸¸ 
IActionResult
¸¸ '
>
¸¸' (
Edit
¸¸) -
(
¸¸- .
int
¸¸. 1
?
¸¸1 2
id
¸¸3 5
)
¸¸5 6
{
˝˝ 	
if
˛˛ 
(
˛˛ 
id
˛˛ 
==
˛˛ 
null
˛˛ 
||
˛˛ 
_context
˛˛ &
.
˛˛& '
Reservas
˛˛' /
==
˛˛0 2
null
˛˛3 7
)
˛˛7 8
{
ˇˇ 
return
ÄÄ 
NotFound
ÄÄ 
(
ÄÄ  
)
ÄÄ  !
;
ÄÄ! "
}
ÅÅ 
var
ÉÉ 
userId
ÉÉ 
=
ÉÉ 
User
ÉÉ 
.
ÉÉ 
FindFirstValue
ÉÉ ,
(
ÉÉ, -

ClaimTypes
ÉÉ- 7
.
ÉÉ7 8
NameIdentifier
ÉÉ8 F
)
ÉÉF G
;
ÉÉG H
var
ÖÖ 
clienteUsuario
ÖÖ 
=
ÖÖ  
_context
ÖÖ! )
.
ÖÖ) *
Usuarios
ÖÖ* 2
.
ÜÜ 
FirstOrDefault
ÜÜ 
(
ÜÜ  
ue
ÜÜ  "
=>
ÜÜ# %
ue
ÜÜ& (
.
ÜÜ( )

id_usuario
ÜÜ) 3
==
ÜÜ4 6
int
ÜÜ7 :
.
ÜÜ: ;
Parse
ÜÜ; @
(
ÜÜ@ A
userId
ÜÜA G
)
ÜÜG H
)
ÜÜH I
;
ÜÜI J
ViewBag
ââ 
.
ââ 
nombreCliente
ââ !
=
ââ" #
$"
ââ$ &
{
ââ& '
clienteUsuario
ââ' 5
.
ââ5 6
nombres
ââ6 =
}
ââ= >
"
ââ> ?
;
ââ? @
var
ãã 
reservas
ãã 
=
ãã 
await
ãã  
_context
ãã! )
.
ãã) *
Reservas
ãã* 2
.
åå 
Include
åå 
(
åå 
r
åå 
=>
åå 
r
åå 
.
åå 
Campo
åå !
)
åå! "
.
çç 
ThenInclude
çç 
(
çç 
r
çç 
=>
çç 
r
çç 
.
çç  
Empresa
çç  '
)
çç' (
.
éé 
Include
éé 
(
éé 
r
éé 
=>
éé 
r
éé 
.
éé 
Campo
éé !
)
éé! "
.
èè 

FirstAsync
èè 
(
èè 
r
èè 
=>
èè 
r
èè 
.
èè 

id_reserva
èè )
==
èè* ,
id
èè- /
)
èè/ 0
;
èè0 1
if
ëë 
(
ëë 
reservas
ëë 
==
ëë 
null
ëë  
)
ëë  !
{
íí 
return
ìì 
NotFound
ìì 
(
ìì  
)
ìì  !
;
ìì! "
}
îî 
decimal
ññ 
	costoHora
ññ 
=
ññ 
reservas
ññ  (
.
ññ( )
ObtenerCostoHora
ññ) 9
(
ññ9 :
reservas
ññ: B
.
ññB C
horaReserva
ññC N
,
ññN O
reservas
ññP X
.
ññX Y
Campo
ññY ^
)
ññ^ _
;
ññ_ `
ViewBag
òò 
.
òò 
IdCancha
òò 
=
òò 
$"
òò !
{
òò! "
reservas
òò" *
.
òò* +
Campo
òò+ 0
.
òò0 1
	id_cancha
òò1 :
}
òò: ;
"
òò; <
;
òò< =
ViewBag
ôô 
.
ôô 
NombreEmpresa
ôô !
=
ôô" #
$"
ôô$ &
{
ôô& '
reservas
ôô' /
.
ôô/ 0
Campo
ôô0 5
.
ôô5 6
Empresa
ôô6 =
.
ôô= >
nombre
ôô> D
}
ôôD E
"
ôôE F
;
ôôF G
ViewBag
öö 
.
öö 
deporteCampo
öö  
=
öö! "
$"
öö# %
{
öö% &
reservas
öö& .
.
öö. /
Campo
öö/ 4
.
öö4 5
deporte
öö5 <
}
öö< =
"
öö= >
;
öö> ?
ViewBag
úú 
.
úú 
	CostoHora
úú 
=
úú 
	costoHora
úú  )
;
úú) *
IEnumerable
ûû 
<
ûû 
SelectListItem
ûû &
>
ûû& '
usuario
ûû( /
=
ûû0 1
_context
ûû2 :
.
ûû: ;
Usuarios
ûû; C
.
üü 
Where
üü 
(
üü 
x
üü 
=>
üü 
x
üü 
.
üü 
id_rol
üü $
==
üü% '
$num
üü( )
)
üü) *
.
†† 
Select
†† 
(
†† 
u
†† 
=>
†† 
new
††  
SelectListItem
††! /
{
°° 
Text
¢¢ 
=
¢¢ 
u
¢¢ 
.
¢¢ 
nombres
¢¢ $
,
¢¢$ %
Value
££ 
=
££ 
u
££ 
.
££ 

id_usuario
££ (
.
££( )
ToString
££) 1
(
££1 2
)
££2 3
}
§§ 
)
§§ 
;
§§ 
ViewBag
•• 
.
•• 
usuario
•• 
=
•• 
usuario
•• %
;
••% &
IEnumerable
®® 
<
®® 
SelectListItem
®® &
>
®®& '
pago
®®( ,
=
®®- .
_context
®®/ 7
.
®®7 8
Pagos
®®8 =
.
®®= >
Select
®®> D
(
®®D E
p
®®E F
=>
®®G I
new
®®J M
SelectListItem
®®N \
{
©© 
Text
™™ 
=
™™ 
p
™™ 
.
™™ 
Descripcion
™™ $
,
™™$ %
Value
´´ 
=
´´ 
p
´´ 
.
´´ 
id_pagos
´´ "
.
´´" #
ToString
´´# +
(
´´+ ,
)
´´, -
}
¨¨ 
)
¨¨ 
;
¨¨ 
ViewBag
≠≠ 
.
≠≠ 
pago
≠≠ 
=
≠≠ 
pago
≠≠ 
;
≠≠  
return
ØØ 
View
ØØ 
(
ØØ 
reservas
ØØ  
)
ØØ  !
;
ØØ! "
}
∞∞ 	
[
≤≤ 	
HttpPost
≤≤	 
]
≤≤ 
[
≥≥ 	&
ValidateAntiForgeryToken
≥≥	 !
]
≥≥! "
public
¥¥ 
async
¥¥ 
Task
¥¥ 
<
¥¥ 
IActionResult
¥¥ '
>
¥¥' (
Edit
¥¥) -
(
¥¥- .
int
¥¥. 1
id
¥¥2 4
,
¥¥4 5
Reservas
¥¥6 >
reservas
¥¥? G
,
¥¥G H
int
¥¥I L
idCancha
¥¥M U
)
¥¥U V
{
µµ 	
if
∂∂ 
(
∂∂ 
id
∂∂ 
!=
∂∂ 
reservas
∂∂ 
.
∂∂ 

id_reserva
∂∂ )
)
∂∂) *
{
∑∑ 
return
∏∏ 
NotFound
∏∏ 
(
∏∏  
)
∏∏  !
;
∏∏! "
}
ππ 
if
ªª 
(
ªª 

ModelState
ªª 
.
ªª 
IsValid
ªª "
)
ªª" #
{
ºº 
try
ΩΩ 
{
ææ 
if
øø 
(
øø 
User
øø 
.
øø 
IsInRole
øø %
(
øø% &
$str
øø& /
)
øø/ 0
)
øø0 1
{
¿¿ 
var
¡¡ 
userID
¡¡ "
=
¡¡# $
User
¡¡% )
.
¡¡) *
FindFirstValue
¡¡* 8
(
¡¡8 9

ClaimTypes
¡¡9 C
.
¡¡C D
NameIdentifier
¡¡D R
)
¡¡R S
;
¡¡S T
if
√√ 
(
√√ 
userID
√√ "
!=
√√# %
null
√√& *
)
√√* +
{
ƒƒ 
reservas
≈≈ $
.
≈≈$ %
	ClienteID
≈≈% .
=
≈≈/ 0
int
≈≈1 4
.
≈≈4 5
Parse
≈≈5 :
(
≈≈: ;
userID
≈≈; A
)
≈≈A B
;
≈≈B C
reservas
∆∆ $
.
∆∆$ %
CampoID
∆∆% ,
=
∆∆- .
idCancha
∆∆/ 7
;
∆∆7 8
}
«« 
else
»» 
{
…… 
return
ÀÀ "
Forbid
ÀÀ# )
(
ÀÀ) *
)
ÀÀ* +
;
ÀÀ+ ,
}
ÃÃ 
}
ÕÕ 
else
ŒŒ 
if
ŒŒ 
(
ŒŒ 
User
ŒŒ !
.
ŒŒ! "
IsInRole
ŒŒ" *
(
ŒŒ* +
$str
ŒŒ+ :
)
ŒŒ: ;
)
ŒŒ; <
{
œœ 
var
—— 
originalReserva
—— +
=
——, -
await
——. 3
_context
——4 <
.
——< =
Reservas
——= E
.
““ 
AsNoTracking
““ )
(
““) *
)
““* +
.
”” 

FirstAsync
”” '
(
””' (
r
””( )
=>
””* ,
r
””- .
.
””. /

id_reserva
””/ 9
==
””: <
id
””= ?
)
””? @
;
””@ A
reservas
’’  
.
’’  !
	ClienteID
’’! *
=
’’+ ,
originalReserva
’’- <
.
’’< =
	ClienteID
’’= F
;
’’F G
}
◊◊ 
_context
ŸŸ 
.
ŸŸ 
Update
ŸŸ #
(
ŸŸ# $
reservas
ŸŸ$ ,
)
ŸŸ, -
;
ŸŸ- .
await
⁄⁄ 
_context
⁄⁄ "
.
⁄⁄" #
SaveChangesAsync
⁄⁄# 3
(
⁄⁄3 4
)
⁄⁄4 5
;
⁄⁄5 6
}
€€ 
catch
‹‹ 
(
‹‹ *
DbUpdateConcurrencyException
‹‹ 3
)
‹‹3 4
{
›› 
if
ﬁﬁ 
(
ﬁﬁ 
!
ﬁﬁ 
ReservasExists
ﬁﬁ '
(
ﬁﬁ' (
reservas
ﬁﬁ( 0
.
ﬁﬁ0 1

id_reserva
ﬁﬁ1 ;
)
ﬁﬁ; <
)
ﬁﬁ< =
{
ﬂﬂ 
return
‡‡ 
NotFound
‡‡ '
(
‡‡' (
)
‡‡( )
;
‡‡) *
}
·· 
else
‚‚ 
{
„„ 
throw
‰‰ 
;
‰‰ 
}
ÂÂ 
}
ÊÊ 
return
ÁÁ 
RedirectToAction
ÁÁ '
(
ÁÁ' (
nameof
ÁÁ( .
(
ÁÁ. /
Index
ÁÁ/ 4
)
ÁÁ4 5
)
ÁÁ5 6
;
ÁÁ6 7
}
ËË 
return
ÓÓ 
View
ÓÓ 
(
ÓÓ 
reservas
ÓÓ  
)
ÓÓ  !
;
ÓÓ! "
}
ÔÔ 	
[
ÙÙ 	
	Authorize
ÙÙ	 
(
ÙÙ 
Roles
ÙÙ 
=
ÙÙ 
$str
ÙÙ $
)
ÙÙ$ %
]
ÙÙ% &
public
ıı 
async
ıı 
Task
ıı 
<
ıı 
IActionResult
ıı '
>
ıı' (
Delete
ıı) /
(
ıı/ 0
int
ıı0 3
?
ıı3 4
id
ıı5 7
)
ıı7 8
{
ˆˆ 	
if
˜˜ 
(
˜˜ 
id
˜˜ 
==
˜˜ 
null
˜˜ 
||
˜˜ 
_context
˜˜ &
.
˜˜& '
Reservas
˜˜' /
==
˜˜0 2
null
˜˜3 7
)
˜˜7 8
{
¯¯ 
return
˘˘ 
NotFound
˘˘ 
(
˘˘  
)
˘˘  !
;
˘˘! "
}
˙˙ 
var
¸¸ 
reservas
¸¸ 
=
¸¸ 
await
¸¸  
_context
¸¸! )
.
¸¸) *
Reservas
¸¸* 2
.
˝˝ 
Include
˝˝ 
(
˝˝ 
r
˝˝ 
=>
˝˝ 
r
˝˝ 
.
˝˝  
Campo
˝˝  %
)
˝˝% &
.
˛˛ 
ThenInclude
˛˛ 
(
˛˛ 
r
˛˛ 
=>
˛˛ !
r
˛˛" #
.
˛˛# $
Empresa
˛˛$ +
)
˛˛+ ,
.
ˇˇ 
Include
ˇˇ 
(
ˇˇ 
r
ˇˇ 
=>
ˇˇ 
r
ˇˇ 
.
ˇˇ  
Cliente
ˇˇ  '
)
ˇˇ' (
.
ÄÄ 

FirstAsync
ÄÄ 
(
ÄÄ 
m
ÄÄ 
=>
ÄÄ  
m
ÄÄ! "
.
ÄÄ" #

id_reserva
ÄÄ# -
==
ÄÄ. 0
id
ÄÄ1 3
)
ÄÄ3 4
;
ÄÄ4 5
if
ÇÇ 
(
ÇÇ 
reservas
ÇÇ 
==
ÇÇ 
null
ÇÇ  
)
ÇÇ  !
{
ÉÉ 
return
ÑÑ 
NotFound
ÑÑ 
(
ÑÑ  
)
ÑÑ  !
;
ÑÑ! "
}
ÖÖ 
return
áá 
View
áá 
(
áá 
reservas
áá  
)
áá  !
;
áá! "
}
àà 	
[
ãã 	
HttpPost
ãã	 
,
ãã 

ActionName
ãã 
(
ãã 
$str
ãã &
)
ãã& '
]
ãã' (
[
åå 	&
ValidateAntiForgeryToken
åå	 !
]
åå! "
public
çç 
async
çç 
Task
çç 
<
çç 
IActionResult
çç '
>
çç' (
DeleteConfirmed
çç) 8
(
çç8 9
int
çç9 <
id
çç= ?
)
çç? @
{
éé 	
if
èè 
(
èè 
_context
èè 
.
èè 
Reservas
èè !
==
èè" $
null
èè% )
)
èè) *
{
êê 
return
ëë 
Problem
ëë 
(
ëë 
$str
ëë M
)
ëëM N
;
ëëN O
}
íí 
var
ìì 
reservas
ìì 
=
ìì 
await
ìì  
_context
ìì! )
.
ìì) *
Reservas
ìì* 2
.
ìì2 3
	FindAsync
ìì3 <
(
ìì< =
id
ìì= ?
)
ìì? @
;
ìì@ A
if
îî 
(
îî 
reservas
îî 
!=
îî 
null
îî  
)
îî  !
{
ïï 
_context
ññ 
.
ññ 
Reservas
ññ !
.
ññ! "
Remove
ññ" (
(
ññ( )
reservas
ññ) 1
)
ññ1 2
;
ññ2 3
}
óó 
await
ôô 
_context
ôô 
.
ôô 
SaveChangesAsync
ôô +
(
ôô+ ,
)
ôô, -
;
ôô- .
return
öö 
RedirectToAction
öö #
(
öö# $
nameof
öö$ *
(
öö* +
Index
öö+ 0
)
öö0 1
)
öö1 2
;
öö2 3
}
õõ 	
private
ùù 
bool
ùù 
ReservasExists
ùù #
(
ùù# $
int
ùù$ '
id
ùù( *
)
ùù* +
{
ûû 	
return
üü 
(
üü 
_context
üü 
.
üü 
Reservas
üü %
?
üü% &
.
üü& '
Any
üü' *
(
üü* +
e
üü+ ,
=>
üü- /
e
üü0 1
.
üü1 2

id_reserva
üü2 <
==
üü= ?
id
üü@ B
)
üüB C
)
üüC D
.
üüD E
GetValueOrDefault
üüE V
(
üüV W
)
üüW X
;
üüX Y
}
†† 	
}
°° 
}¢¢ ‹q
|C:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Controllers\User_EmpresaController.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $
Controllers$ /
{ 
public 

class "
User_EmpresaController '
:( )

Controller* 4
{ 
private 
readonly 
AppDbContext %
_context& .
;. /
public "
User_EmpresaController %
(% &
AppDbContext& 2
context3 :
): ;
{ 	
_context 
= 
context 
; 
} 	
public 
async 
Task 
< 
IActionResult '
>' (
Index) .
(. /
)/ 0
{ 	
var 
appDbContext 
= 
_context '
.' (
User_Empresa( 4
.4 5
Include5 <
(< =
u= >
=>? A
uB C
.C D
EmpresaD K
)K L
.L M
IncludeM T
(T U
uU V
=>W Y
uZ [
.[ \
Usuario\ c
)c d
;d e
return 
View 
( 
await 
appDbContext *
.* +
ToListAsync+ 6
(6 7
)7 8
)8 9
;9 :
} 	
public 
async 
Task 
< 
IActionResult '
>' (
Details) 0
(0 1
int1 4
?4 5
id6 8
)8 9
{ 	
if   
(   
id   
==   
null   
||   
_context   &
.  & '
User_Empresa  ' 3
==  4 6
null  7 ;
)  ; <
{!! 
return"" 
NotFound"" 
(""  
)""  !
;""! "
}## 
var%% 
user_Empresa%% 
=%% 
await%% $
_context%%% -
.%%- .
User_Empresa%%. :
.&& 
Include&& 
(&& 
u&& 
=>&& 
u&& 
.&&  
Empresa&&  '
)&&' (
.'' 
Include'' 
('' 
u'' 
=>'' 
u'' 
.''  
Usuario''  '
)''' (
.(( 
FirstOrDefaultAsync(( $
((($ %
m((% &
=>((' )
m((* +
.((+ ,
User_EmpresaID((, :
==((; =
id((> @
)((@ A
;((A B
if)) 
()) 
user_Empresa)) 
==)) 
null))  $
)))$ %
{** 
return++ 
NotFound++ 
(++  
)++  !
;++! "
},, 
return.. 
View.. 
(.. 
user_Empresa.. $
)..$ %
;..% &
}// 	
public22 
IActionResult22 
Create22 #
(22# $
)22$ %
{33 	
ViewData44 
[44 
$str44 !
]44! "
=44# $
new44% (

SelectList44) 3
(443 4
_context444 <
.44< =
Empresas44= E
,44E F
$str44G S
,44S T
$str44U ^
)44^ _
;44_ `
ViewData55 
[55 
$str55 !
]55! "
=55# $
new55% (

SelectList55) 3
(553 4
_context554 <
.55< =
Usuarios55= E
,55E F
$str55G S
,55S T
$str55U `
)55` a
;55a b
return66 
View66 
(66 
)66 
;66 
}77 	
[<< 	
HttpPost<<	 
]<< 
[== 	$
ValidateAntiForgeryToken==	 !
]==! "
public>> 
async>> 
Task>> 
<>> 
IActionResult>> '
>>>' (
Create>>) /
(>>/ 0
[>>0 1
Bind>>1 5
(>>5 6
$str>>6 \
)>>\ ]
]>>] ^
User_Empresa>>_ k
user_Empresa>>l x
)>>x y
{?? 	
if@@ 
(@@ 

ModelState@@ 
.@@ 
IsValid@@ "
)@@" #
{AA 
_contextBB 
.BB 
AddBB 
(BB 
user_EmpresaBB )
)BB) *
;BB* +
awaitCC 
_contextCC 
.CC 
SaveChangesAsyncCC /
(CC/ 0
)CC0 1
;CC1 2
returnDD 
RedirectToActionDD '
(DD' (
nameofDD( .
(DD. /
IndexDD/ 4
)DD4 5
)DD5 6
;DD6 7
}EE 
ViewDataFF 
[FF 
$strFF !
]FF! "
=FF# $
newFF% (

SelectListFF) 3
(FF3 4
_contextFF4 <
.FF< =
EmpresasFF= E
,FFE F
$strFFG S
,FFS T
$strFFU ^
,FF^ _
user_EmpresaFF` l
.FFl m

id_empresaFFm w
)FFw x
;FFx y
ViewDataGG 
[GG 
$strGG !
]GG! "
=GG# $
newGG% (

SelectListGG) 3
(GG3 4
_contextGG4 <
.GG< =
UsuariosGG= E
,GGE F
$strGGG S
,GGS T
$strGGU `
,GG` a
user_EmpresaGGb n
.GGn o

id_usuarioGGo y
)GGy z
;GGz {
returnHH 
ViewHH 
(HH 
user_EmpresaHH $
)HH$ %
;HH% &
}II 	
publicLL 
asyncLL 
TaskLL 
<LL 
IActionResultLL '
>LL' (
EditLL) -
(LL- .
intLL. 1
?LL1 2
idLL3 5
)LL5 6
{MM 	
ifNN 
(NN 
idNN 
==NN 
nullNN 
||NN 
_contextNN &
.NN& '
User_EmpresaNN' 3
==NN4 6
nullNN7 ;
)NN; <
{OO 
returnPP 
NotFoundPP 
(PP  
)PP  !
;PP! "
}QQ 
varSS 
user_EmpresaSS 
=SS 
awaitSS $
_contextSS% -
.SS- .
User_EmpresaSS. :
.SS: ;
	FindAsyncSS; D
(SSD E
idSSE G
)SSG H
;SSH I
ifTT 
(TT 
user_EmpresaTT 
==TT 
nullTT  $
)TT$ %
{UU 
returnVV 
NotFoundVV 
(VV  
)VV  !
;VV! "
}WW 
ViewDataXX 
[XX 
$strXX !
]XX! "
=XX# $
newXX% (

SelectListXX) 3
(XX3 4
_contextXX4 <
.XX< =
EmpresasXX= E
,XXE F
$strXXG S
,XXS T
$strXXU ^
,XX^ _
user_EmpresaXX` l
.XXl m

id_empresaXXm w
)XXw x
;XXx y
ViewDataYY 
[YY 
$strYY !
]YY! "
=YY# $
newYY% (

SelectListYY) 3
(YY3 4
_contextYY4 <
.YY< =
UsuariosYY= E
,YYE F
$strYYG S
,YYS T
$strYYU `
,YY` a
user_EmpresaYYb n
.YYn o

id_usuarioYYo y
)YYy z
;YYz {
returnZZ 
ViewZZ 
(ZZ 
user_EmpresaZZ $
)ZZ$ %
;ZZ% &
}[[ 	
[`` 	
HttpPost``	 
]`` 
[aa 	$
ValidateAntiForgeryTokenaa	 !
]aa! "
publicbb 
asyncbb 
Taskbb 
<bb 
IActionResultbb '
>bb' (
Editbb) -
(bb- .
intbb. 1
idbb2 4
,bb4 5
[bb6 7
Bindbb7 ;
(bb; <
$strbb< b
)bbb c
]bbc d
User_Empresabbe q
user_Empresabbr ~
)bb~ 
{cc 	
ifdd 
(dd 
iddd 
!=dd 
user_Empresadd "
.dd" #
User_EmpresaIDdd# 1
)dd1 2
{ee 
returnff 
NotFoundff 
(ff  
)ff  !
;ff! "
}gg 
ifii 
(ii 

ModelStateii 
.ii 
IsValidii "
)ii" #
{jj 
trykk 
{ll 
_contextmm 
.mm 
Updatemm #
(mm# $
user_Empresamm$ 0
)mm0 1
;mm1 2
awaitnn 
_contextnn "
.nn" #
SaveChangesAsyncnn# 3
(nn3 4
)nn4 5
;nn5 6
}oo 
catchpp 
(pp (
DbUpdateConcurrencyExceptionpp 3
)pp3 4
{qq 
ifrr 
(rr 
!rr 
User_EmpresaExistsrr +
(rr+ ,
user_Empresarr, 8
.rr8 9
User_EmpresaIDrr9 G
)rrG H
)rrH I
{ss 
returntt 
NotFoundtt '
(tt' (
)tt( )
;tt) *
}uu 
elsevv 
{ww 
throwxx 
;xx 
}yy 
}zz 
return{{ 
RedirectToAction{{ '
({{' (
nameof{{( .
({{. /
Index{{/ 4
){{4 5
){{5 6
;{{6 7
}|| 
ViewData}} 
[}} 
$str}} !
]}}! "
=}}# $
new}}% (

SelectList}}) 3
(}}3 4
_context}}4 <
.}}< =
Empresas}}= E
,}}E F
$str}}G S
,}}S T
$str}}U ^
,}}^ _
user_Empresa}}` l
.}}l m

id_empresa}}m w
)}}w x
;}}x y
ViewData~~ 
[~~ 
$str~~ !
]~~! "
=~~# $
new~~% (

SelectList~~) 3
(~~3 4
_context~~4 <
.~~< =
Usuarios~~= E
,~~E F
$str~~G S
,~~S T
$str~~U `
,~~` a
user_Empresa~~b n
.~~n o

id_usuario~~o y
)~~y z
;~~z {
return 
View 
( 
user_Empresa $
)$ %
;% &
}
ÄÄ 	
public
ÉÉ 
async
ÉÉ 
Task
ÉÉ 
<
ÉÉ 
IActionResult
ÉÉ '
>
ÉÉ' (
Delete
ÉÉ) /
(
ÉÉ/ 0
int
ÉÉ0 3
?
ÉÉ3 4
id
ÉÉ5 7
)
ÉÉ7 8
{
ÑÑ 	
if
ÖÖ 
(
ÖÖ 
id
ÖÖ 
==
ÖÖ 
null
ÖÖ 
||
ÖÖ 
_context
ÖÖ &
.
ÖÖ& '
User_Empresa
ÖÖ' 3
==
ÖÖ4 6
null
ÖÖ7 ;
)
ÖÖ; <
{
ÜÜ 
return
áá 
NotFound
áá 
(
áá  
)
áá  !
;
áá! "
}
àà 
var
ää 
user_Empresa
ää 
=
ää 
await
ää $
_context
ää% -
.
ää- .
User_Empresa
ää. :
.
ãã 
Include
ãã 
(
ãã 
u
ãã 
=>
ãã 
u
ãã 
.
ãã  
Empresa
ãã  '
)
ãã' (
.
åå 
Include
åå 
(
åå 
u
åå 
=>
åå 
u
åå 
.
åå  
Usuario
åå  '
)
åå' (
.
çç !
FirstOrDefaultAsync
çç $
(
çç$ %
m
çç% &
=>
çç' )
m
çç* +
.
çç+ ,
User_EmpresaID
çç, :
==
çç; =
id
çç> @
)
çç@ A
;
ççA B
if
éé 
(
éé 
user_Empresa
éé 
==
éé 
null
éé  $
)
éé$ %
{
èè 
return
êê 
NotFound
êê 
(
êê  
)
êê  !
;
êê! "
}
ëë 
return
ìì 
View
ìì 
(
ìì 
user_Empresa
ìì $
)
ìì$ %
;
ìì% &
}
îî 	
[
óó 	
HttpPost
óó	 
,
óó 

ActionName
óó 
(
óó 
$str
óó &
)
óó& '
]
óó' (
[
òò 	&
ValidateAntiForgeryToken
òò	 !
]
òò! "
public
ôô 
async
ôô 
Task
ôô 
<
ôô 
IActionResult
ôô '
>
ôô' (
DeleteConfirmed
ôô) 8
(
ôô8 9
int
ôô9 <
id
ôô= ?
)
ôô? @
{
öö 	
if
õõ 
(
õõ 
_context
õõ 
.
õõ 
User_Empresa
õõ %
==
õõ& (
null
õõ) -
)
õõ- .
{
úú 
return
ùù 
Problem
ùù 
(
ùù 
$str
ùù Q
)
ùùQ R
;
ùùR S
}
ûû 
var
üü 
user_Empresa
üü 
=
üü 
await
üü $
_context
üü% -
.
üü- .
User_Empresa
üü. :
.
üü: ;
	FindAsync
üü; D
(
üüD E
id
üüE G
)
üüG H
;
üüH I
if
†† 
(
†† 
user_Empresa
†† 
!=
†† 
null
††  $
)
††$ %
{
°° 
_context
¢¢ 
.
¢¢ 
User_Empresa
¢¢ %
.
¢¢% &
Remove
¢¢& ,
(
¢¢, -
user_Empresa
¢¢- 9
)
¢¢9 :
;
¢¢: ;
}
££ 
await
•• 
_context
•• 
.
•• 
SaveChangesAsync
•• +
(
••+ ,
)
••, -
;
••- .
return
¶¶ 
RedirectToAction
¶¶ #
(
¶¶# $
nameof
¶¶$ *
(
¶¶* +
Index
¶¶+ 0
)
¶¶0 1
)
¶¶1 2
;
¶¶2 3
}
ßß 	
private
©© 
bool
©©  
User_EmpresaExists
©© '
(
©©' (
int
©©( +
id
©©, .
)
©©. /
{
™™ 	
return
´´
 
(
´´ 
_context
´´ 
.
´´ 
User_Empresa
´´ '
?
´´' (
.
´´( )
Any
´´) ,
(
´´, -
e
´´- .
=>
´´/ 1
e
´´2 3
.
´´3 4
User_EmpresaID
´´4 B
==
´´C E
id
´´F H
)
´´H I
)
´´I J
.
´´J K
GetValueOrDefault
´´K \
(
´´\ ]
)
´´] ^
;
´´^ _
}
¨¨ 	
}
≠≠ 
}ÆÆ éT
xC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Controllers\UsuariosController.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $
Controllers$ /
{ 
public 

class 
UsuariosController #
:$ %

Controller& 0
{ 
private 
readonly 
AppDbContext %
_context& .
;. /
public 
UsuariosController !
(! "
AppDbContext" .
context/ 6
)6 7
{ 	
_context 
= 
context 
; 
} 	
[ 	
	Authorize	 
( 
Roles 
= 
$str '
)' (
]( )
public 
async 
Task 
< 
IActionResult '
>' (
Index) .
(. /
)/ 0
{ 	
var 
appDbContext 
= 
_context '
.' (
Usuarios( 0
.0 1
Include1 8
(8 9
u9 :
=>; =
u> ?
.? @
Rol@ C
)C D
;D E
return 
View 
( 
await 
appDbContext *
.* +
ToListAsync+ 6
(6 7
)7 8
)8 9
;9 :
} 	
public!! 
async!! 
Task!! 
<!! 
IActionResult!! '
>!!' (
Details!!) 0
(!!0 1
int!!1 4
?!!4 5
id!!6 8
)!!8 9
{"" 	
if## 
(## 
id## 
==## 
null## 
||## 
_context## &
.##& '
Usuarios##' /
==##0 2
null##3 7
)##7 8
{$$ 
return%% 
NotFound%% 
(%%  
)%%  !
;%%! "
}&& 
var(( 
usuarios(( 
=(( 
await((  
_context((! )
.(() *
Usuarios((* 2
.)) 
Include)) 
()) 
u)) 
=>)) 
u)) 
.))  
Rol))  #
)))# $
.** 
FirstOrDefaultAsync** $
(**$ %
m**% &
=>**' )
m*** +
.**+ ,

id_usuario**, 6
==**7 9
id**: <
)**< =
;**= >
if++ 
(++ 
usuarios++ 
==++ 
null++  
)++  !
{,, 
return-- 
NotFound-- 
(--  
)--  !
;--! "
}.. 
return00 
View00 
(00 
usuarios00  
)00  !
;00! "
}11 	
publicLL 
asyncLL 
TaskLL 
<LL 
IActionResultLL '
>LL' (
EditLL) -
(LL- .
intLL. 1
?LL1 2
idLL3 5
)LL5 6
{MM 	
ifNN 
(NN 
idNN 
==NN 
nullNN 
||NN 
_contextNN &
.NN& '
UsuariosNN' /
==NN0 2
nullNN3 7
)NN7 8
{OO 
returnPP 
NotFoundPP 
(PP  
)PP  !
;PP! "
}QQ 
varSS 
usuariosSS 
=SS 
awaitSS  
_contextSS! )
.SS) *
UsuariosSS* 2
.SS2 3
	FindAsyncSS3 <
(SS< =
idSS= ?
)SS? @
;SS@ A
ifTT 
(TT 
usuariosTT 
==TT 
nullTT  
)TT  !
{UU 
returnVV 
NotFoundVV 
(VV  
)VV  !
;VV! "
}WW 
ViewDataXX 
[XX 
$strXX 
]XX 
=XX  
newXX! $

SelectListXX% /
(XX/ 0
_contextXX0 8
.XX8 9
RolesXX9 >
,XX> ?
$strXX@ G
,XXG H
$strXXI P
,XXP Q
usuariosXXR Z
.XXZ [
id_rolXX[ a
)XXa b
;XXb c
returnYY 
ViewYY 
(YY 
usuariosYY  
)YY  !
;YY! "
}ZZ 	
[__ 	
HttpPost__	 
]__ 
[`` 	$
ValidateAntiForgeryToken``	 !
]``! "
publicaa 
asyncaa 
Taskaa 
<aa 
IActionResultaa '
>aa' (
Editaa) -
(aa- .
intaa. 1
idaa2 4
,aa4 5
[aa6 7
Bindaa7 ;
(aa; <
$str	aa< ú
)
aaú ù
]
aaù û
Usuarios
aaü ß
usuarios
aa® ∞
)
aa∞ ±
{bb 	
ifcc 
(cc 
idcc 
!=cc 
usuarioscc 
.cc 

id_usuariocc )
)cc) *
{dd 
returnee 
NotFoundee 
(ee  
)ee  !
;ee! "
}ff 
ifhh 
(hh 

ModelStatehh 
.hh 
IsValidhh "
)hh" #
{ii 
tryjj 
{kk 
_contextll 
.ll 
Updatell #
(ll# $
usuariosll$ ,
)ll, -
;ll- .
awaitmm 
_contextmm "
.mm" #
SaveChangesAsyncmm# 3
(mm3 4
)mm4 5
;mm5 6
}nn 
catchoo 
(oo (
DbUpdateConcurrencyExceptionoo 3
)oo3 4
{pp 
ifqq 
(qq 
!qq 
UsuariosExistsqq '
(qq' (
usuariosqq( 0
.qq0 1

id_usuarioqq1 ;
)qq; <
)qq< =
{rr 
returnss 
NotFoundss '
(ss' (
)ss( )
;ss) *
}tt 
elseuu 
{vv 
throwww 
;ww 
}xx 
}yy 
returnzz 
RedirectToActionzz '
(zz' (
nameofzz( .
(zz. /
Indexzz/ 4
)zz4 5
)zz5 6
;zz6 7
}{{ 
ViewData|| 
[|| 
$str|| 
]|| 
=||  
new||! $

SelectList||% /
(||/ 0
_context||0 8
.||8 9
Roles||9 >
,||> ?
$str||@ G
,||G H
$str||I P
,||P Q
usuarios||R Z
.||Z [
id_rol||[ a
)||a b
;||b c
return}} 
View}} 
(}} 
usuarios}}  
)}}  !
;}}! "
}~~ 	
[
ÅÅ 	
	Authorize
ÅÅ	 
(
ÅÅ 
Roles
ÅÅ 
=
ÅÅ 
$str
ÅÅ '
)
ÅÅ' (
]
ÅÅ( )
public
ÇÇ 
async
ÇÇ 
Task
ÇÇ 
<
ÇÇ 
IActionResult
ÇÇ '
>
ÇÇ' (
Delete
ÇÇ) /
(
ÇÇ/ 0
int
ÇÇ0 3
?
ÇÇ3 4
id
ÇÇ5 7
)
ÇÇ7 8
{
ÉÉ 	
if
ÑÑ 
(
ÑÑ 
id
ÑÑ 
==
ÑÑ 
null
ÑÑ 
||
ÑÑ 
_context
ÑÑ &
.
ÑÑ& '
Usuarios
ÑÑ' /
==
ÑÑ0 2
null
ÑÑ3 7
)
ÑÑ7 8
{
ÖÖ 
return
ÜÜ 
NotFound
ÜÜ 
(
ÜÜ  
)
ÜÜ  !
;
ÜÜ! "
}
áá 
var
ââ 
usuarios
ââ 
=
ââ 
await
ââ  
_context
ââ! )
.
ââ) *
Usuarios
ââ* 2
.
ää 
Include
ää 
(
ää 
u
ää 
=>
ää 
u
ää 
.
ää  
Rol
ää  #
)
ää# $
.
ãã !
FirstOrDefaultAsync
ãã $
(
ãã$ %
m
ãã% &
=>
ãã' )
m
ãã* +
.
ãã+ ,

id_usuario
ãã, 6
==
ãã7 9
id
ãã: <
)
ãã< =
;
ãã= >
if
åå 
(
åå 
usuarios
åå 
==
åå 
null
åå  
)
åå  !
{
çç 
return
éé 
NotFound
éé 
(
éé  
)
éé  !
;
éé! "
}
èè 
return
ëë 
View
ëë 
(
ëë 
usuarios
ëë  
)
ëë  !
;
ëë! "
}
íí 	
[
ïï 	
HttpPost
ïï	 
,
ïï 

ActionName
ïï 
(
ïï 
$str
ïï &
)
ïï& '
]
ïï' (
[
ññ 	&
ValidateAntiForgeryToken
ññ	 !
]
ññ! "
public
óó 
async
óó 
Task
óó 
<
óó 
IActionResult
óó '
>
óó' (
DeleteConfirmed
óó) 8
(
óó8 9
int
óó9 <
id
óó= ?
)
óó? @
{
òò 	
if
ôô 
(
ôô 
_context
ôô 
.
ôô 
Usuarios
ôô !
==
ôô" $
null
ôô% )
)
ôô) *
{
öö 
return
õõ 
Problem
õõ 
(
õõ 
$str
õõ M
)
õõM N
;
õõN O
}
úú 
var
ùù 
usuarios
ùù 
=
ùù 
await
ùù  
_context
ùù! )
.
ùù) *
Usuarios
ùù* 2
.
ùù2 3
	FindAsync
ùù3 <
(
ùù< =
id
ùù= ?
)
ùù? @
;
ùù@ A
if
ûû 
(
ûû 
usuarios
ûû 
!=
ûû 
null
ûû  
)
ûû  !
{
üü 
_context
†† 
.
†† 
Usuarios
†† !
.
††! "
Remove
††" (
(
††( )
usuarios
††) 1
)
††1 2
;
††2 3
}
°° 
await
££ 
_context
££ 
.
££ 
SaveChangesAsync
££ +
(
££+ ,
)
££, -
;
££- .
return
§§ 
RedirectToAction
§§ #
(
§§# $
nameof
§§$ *
(
§§* +
Index
§§+ 0
)
§§0 1
)
§§1 2
;
§§2 3
}
•• 	
private
ßß 
bool
ßß 
UsuariosExists
ßß #
(
ßß# $
int
ßß$ '
id
ßß( *
)
ßß* +
{
®® 	
return
©©
 
(
©© 
_context
©© 
.
©© 
Usuarios
©© #
?
©©# $
.
©©$ %
Any
©©% (
(
©©( )
e
©©) *
=>
©©+ -
e
©©. /
.
©©/ 0

id_usuario
©©0 :
==
©©; =
id
©©> @
)
©©@ A
)
©©A B
.
©©B C
GetValueOrDefault
©©C T
(
©©T U
)
©©U V
;
©©V W
}
™™ 	
}
´´ 
}¨¨ ‘
kC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Data\AppDbContext.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $
Data$ (
{ 
public 

class 
AppDbContext 
: 
	DbContext '
{ 
public 
AppDbContext 
( 
DbContextOptions ,
<, -
AppDbContext- 9
>9 :
options; B
)B C
:D E
baseF J
(J K
optionsK R
)R S
{		 	
} 	
public 
DbSet 
< 
Usuarios 
> 
Usuarios '
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 
Canchas 
> 
Canchas %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
DbSet 
< 
Reservas 
> 
Reservas '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
DbSet 
< 
Empresas 
> 
Empresas '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
DbSet 
< 
Rol 
> 
Roles 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DbSet 
< 

MediosPago 
>  
Pagos! &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 
User_Empresa !
>! "
User_Empresa# /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
} 
} ¬Ÿ
~C:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Migrations\20231121072344_ReservasV5.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $

Migrations$ .
{ 
public		 

partial		 
class		 

ReservasV5		 #
:		$ %
	Migration		& /
{

 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str  
,  !
columns 
: 
table 
=> !
new" %
{ 

id_empresa 
=  
table! &
.& '
Column' -
<- .
int. 1
>1 2
(2 3
type3 7
:7 8
$str9 >
,> ?
nullable@ H
:H I
falseJ O
)O P
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
nombre 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
type2 6
:6 7
$str8 F
,F G
	maxLengthH Q
:Q R
$numS U
,U V
nullableW _
:_ `
falsea f
)f g
,g h
correo 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
type2 6
:6 7
$str8 F
,F G
	maxLengthH Q
:Q R
$numS U
,U V
nullableW _
:_ `
falsea f
)f g
,g h
celular 
= 
table #
.# $
Column$ *
<* +
string+ 1
>1 2
(2 3
type3 7
:7 8
$str9 G
,G H
	maxLengthI R
:R S
$numT V
,V W
nullableX `
:` a
falseb g
)g h
,h i
horaApertura  
=! "
table# (
.( )
Column) /
</ 0
TimeSpan0 8
>8 9
(9 :
type: >
:> ?
$str@ F
,F G
nullableH P
:P Q
falseR W
)W X
,X Y

horaCierre 
=  
table! &
.& '
Column' -
<- .
TimeSpan. 6
>6 7
(7 8
type8 <
:< =
$str> D
,D E
nullableF N
:N O
falseP U
)U V
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 2
,2 3
x4 5
=>6 8
x9 :
.: ;

id_empresa; E
)E F
;F G
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name   
:   
$str   
,   
columns!! 
:!! 
table!! 
=>!! !
new!!" %
{"" 
RolID## 
=## 
table## !
.##! "
Column##" (
<##( )
int##) ,
>##, -
(##- .
type##. 2
:##2 3
$str##4 9
,##9 :
nullable##; C
:##C D
false##E J
)##J K
.$$ 

Annotation$$ #
($$# $
$str$$$ 8
,$$8 9
$str$$: @
)$$@ A
,$$A B
Descripcion%% 
=%%  !
table%%" '
.%%' (
Column%%( .
<%%. /
string%%/ 5
>%%5 6
(%%6 7
type%%7 ;
:%%; <
$str%%= K
,%%K L
	maxLength%%M V
:%%V W
$num%%X Z
,%%Z [
nullable%%\ d
:%%d e
false%%f k
)%%k l
}&& 
,&& 
constraints'' 
:'' 
table'' "
=>''# %
{(( 
table)) 
.)) 

PrimaryKey)) $
())$ %
$str))% /
,))/ 0
x))1 2
=>))3 5
x))6 7
.))7 8
RolID))8 =
)))= >
;))> ?
}** 
)** 
;** 
migrationBuilder,, 
.,, 
CreateTable,, (
(,,( )
name-- 
:-- 
$str-- 
,--  
columns.. 
:.. 
table.. 
=>.. !
new.." %
{// 
	id_cancha00 
=00 
table00  %
.00% &
Column00& ,
<00, -
int00- 0
>000 1
(001 2
type002 6
:006 7
$str008 =
,00= >
nullable00? G
:00G H
false00I N
)00N O
.11 

Annotation11 #
(11# $
$str11$ 8
,118 9
$str11: @
)11@ A
,11A B

id_empresa22 
=22  
table22! &
.22& '
Column22' -
<22- .
int22. 1
>221 2
(222 3
type223 7
:227 8
$str229 >
,22> ?
nullable22@ H
:22H I
false22J O
)22O P
,22P Q
deporte33 
=33 
table33 #
.33# $
Column33$ *
<33* +
string33+ 1
>331 2
(332 3
type333 7
:337 8
$str339 G
,33G H
	maxLength33I R
:33R S
$num33T V
,33V W
nullable33X `
:33` a
false33b g
)33g h
,33h i
detalle44 
=44 
table44 #
.44# $
Column44$ *
<44* +
string44+ 1
>441 2
(442 3
type443 7
:447 8
$str449 G
,44G H
	maxLength44I R
:44R S
$num44T V
,44V W
nullable44X `
:44` a
true44b f
)44f g
,44g h
costoDia55 
=55 
table55 $
.55$ %
Column55% +
<55+ ,
decimal55, 3
>553 4
(554 5
type555 9
:559 :
$str55; J
,55J K
nullable55L T
:55T U
false55V [
)55[ \
,55\ ]

costoNoche66 
=66  
table66! &
.66& '
Column66' -
<66- .
decimal66. 5
>665 6
(666 7
type667 ;
:66; <
$str66= L
,66L M
nullable66N V
:66V W
false66X ]
)66] ^
,66^ _
UrlImage77 
=77 
table77 $
.77$ %
Column77% +
<77+ ,
string77, 2
>772 3
(773 4
type774 8
:778 9
$str77: I
,77I J
nullable77K S
:77S T
true77U Y
)77Y Z
}88 
,88 
constraints99 
:99 
table99 "
=>99# %
{:: 
table;; 
.;; 

PrimaryKey;; $
(;;$ %
$str;;% 1
,;;1 2
x;;3 4
=>;;5 7
x;;8 9
.;;9 :
	id_cancha;;: C
);;C D
;;;D E
table<< 
.<< 

ForeignKey<< $
(<<$ %
name== 
:== 
$str== >
,==> ?
column>> 
:>> 
x>>  !
=>>>" $
x>>% &
.>>& '

id_empresa>>' 1
,>>1 2
principalTable?? &
:??& '
$str??( 2
,??2 3
principalColumn@@ '
:@@' (
$str@@) 5
,@@5 6
onDeleteAA  
:AA  !
ReferentialActionAA" 3
.AA3 4
CascadeAA4 ;
)AA; <
;AA< =
}BB 
)BB 
;BB 
migrationBuilderDD 
.DD 
CreateTableDD (
(DD( )
nameEE 
:EE 
$strEE 
,EE 
columnsFF 
:FF 
tableFF 
=>FF !
newFF" %
{GG 
id_pagosHH 
=HH 
tableHH $
.HH$ %
ColumnHH% +
<HH+ ,
intHH, /
>HH/ 0
(HH0 1
typeHH1 5
:HH5 6
$strHH7 <
,HH< =
nullableHH> F
:HHF G
falseHHH M
)HHM N
.II 

AnnotationII #
(II# $
$strII$ 8
,II8 9
$strII: @
)II@ A
,IIA B

id_empresaJJ 
=JJ  
tableJJ! &
.JJ& '
ColumnJJ' -
<JJ- .
intJJ. 1
>JJ1 2
(JJ2 3
typeJJ3 7
:JJ7 8
$strJJ9 >
,JJ> ?
nullableJJ@ H
:JJH I
falseJJJ O
)JJO P
,JJP Q
NombreKK 
=KK 
tableKK "
.KK" #
ColumnKK# )
<KK) *
stringKK* 0
>KK0 1
(KK1 2
typeKK2 6
:KK6 7
$strKK8 F
,KKF G
	maxLengthKKH Q
:KKQ R
$numKKS U
,KKU V
nullableKKW _
:KK_ `
falseKKa f
)KKf g
,KKg h
DescripcionLL 
=LL  !
tableLL" '
.LL' (
ColumnLL( .
<LL. /
stringLL/ 5
>LL5 6
(LL6 7
typeLL7 ;
:LL; <
$strLL= J
,LLJ K
	maxLengthLLL U
:LLU V
$numLLW X
,LLX Y
nullableLLZ b
:LLb c
falseLLd i
)LLi j
}MM 
,MM 
constraintsNN 
:NN 
tableNN "
=>NN# %
{OO 
tablePP 
.PP 

PrimaryKeyPP $
(PP$ %
$strPP% /
,PP/ 0
xPP1 2
=>PP3 5
xPP6 7
.PP7 8
id_pagosPP8 @
)PP@ A
;PPA B
tableQQ 
.QQ 

ForeignKeyQQ $
(QQ$ %
nameRR 
:RR 
$strRR <
,RR< =
columnSS 
:SS 
xSS  !
=>SS" $
xSS% &
.SS& '

id_empresaSS' 1
,SS1 2
principalTableTT &
:TT& '
$strTT( 2
,TT2 3
principalColumnUU '
:UU' (
$strUU) 5
,UU5 6
onDeleteVV  
:VV  !
ReferentialActionVV" 3
.VV3 4
CascadeVV4 ;
)VV; <
;VV< =
}WW 
)WW 
;WW 
migrationBuilderYY 
.YY 
CreateTableYY (
(YY( )
nameZZ 
:ZZ 
$strZZ  
,ZZ  !
columns[[ 
:[[ 
table[[ 
=>[[ !
new[[" %
{\\ 

id_usuario]] 
=]]  
table]]! &
.]]& '
Column]]' -
<]]- .
int]]. 1
>]]1 2
(]]2 3
type]]3 7
:]]7 8
$str]]9 >
,]]> ?
nullable]]@ H
:]]H I
false]]J O
)]]O P
.^^ 

Annotation^^ #
(^^# $
$str^^$ 8
,^^8 9
$str^^: @
)^^@ A
,^^A B
id_rol__ 
=__ 
table__ "
.__" #
Column__# )
<__) *
int__* -
>__- .
(__. /
type__/ 3
:__3 4
$str__5 :
,__: ;
nullable__< D
:__D E
false__F K
)__K L
,__L M
usuario`` 
=`` 
table`` #
.``# $
Column``$ *
<``* +
string``+ 1
>``1 2
(``2 3
type``3 7
:``7 8
$str``9 G
,``G H
	maxLength``I R
:``R S
$num``T V
,``V W
nullable``X `
:``` a
false``b g
)``g h
,``h i
passaa 
=aa 
tableaa  
.aa  !
Columnaa! '
<aa' (
stringaa( .
>aa. /
(aa/ 0
typeaa0 4
:aa4 5
$straa6 E
,aaE F
nullableaaG O
:aaO P
falseaaQ V
)aaV W
,aaW X
nombresbb 
=bb 
tablebb #
.bb# $
Columnbb$ *
<bb* +
stringbb+ 1
>bb1 2
(bb2 3
typebb3 7
:bb7 8
$strbb9 G
,bbG H
	maxLengthbbI R
:bbR S
$numbbT V
,bbV W
nullablebbX `
:bb` a
falsebbb g
)bbg h
,bbh i
	apellidoscc 
=cc 
tablecc  %
.cc% &
Columncc& ,
<cc, -
stringcc- 3
>cc3 4
(cc4 5
typecc5 9
:cc9 :
$strcc; I
,ccI J
	maxLengthccK T
:ccT U
$numccV X
,ccX Y
nullableccZ b
:ccb c
falseccd i
)cci j
,ccj k
tipoDocumentodd !
=dd" #
tabledd$ )
.dd) *
Columndd* 0
<dd0 1
stringdd1 7
>dd7 8
(dd8 9
typedd9 =
:dd= >
$strdd? M
,ddM N
	maxLengthddO X
:ddX Y
$numddZ \
,dd\ ]
nullabledd^ f
:ddf g
falseddh m
)ddm n
,ddn o
	documentoee 
=ee 
tableee  %
.ee% &
Columnee& ,
<ee, -
stringee- 3
>ee3 4
(ee4 5
typeee5 9
:ee9 :
$stree; H
,eeH I
	maxLengtheeJ S
:eeS T
$numeeU V
,eeV W
nullableeeX `
:ee` a
falseeeb g
)eeg h
,eeh i
correoff 
=ff 
tableff "
.ff" #
Columnff# )
<ff) *
stringff* 0
>ff0 1
(ff1 2
typeff2 6
:ff6 7
$strff8 F
,ffF G
	maxLengthffH Q
:ffQ R
$numffS U
,ffU V
nullableffW _
:ff_ `
falseffa f
)fff g
,ffg h
celulargg 
=gg 
tablegg #
.gg# $
Columngg$ *
<gg* +
stringgg+ 1
>gg1 2
(gg2 3
typegg3 7
:gg7 8
$strgg9 F
,ggF G
	maxLengthggH Q
:ggQ R
$numggS T
,ggT U
nullableggV ^
:gg^ _
falsegg` e
)gge f
,ggf g
estadohh 
=hh 
tablehh "
.hh" #
Columnhh# )
<hh) *
boolhh* .
>hh. /
(hh/ 0
typehh0 4
:hh4 5
$strhh6 ;
,hh; <
nullablehh= E
:hhE F
falsehhG L
)hhL M
}ii 
,ii 
constraintsjj 
:jj 
tablejj "
=>jj# %
{kk 
tablell 
.ll 

PrimaryKeyll $
(ll$ %
$strll% 2
,ll2 3
xll4 5
=>ll6 8
xll9 :
.ll: ;

id_usuarioll; E
)llE F
;llF G
tablemm 
.mm 

ForeignKeymm $
(mm$ %
namenn 
:nn 
$strnn 8
,nn8 9
columnoo 
:oo 
xoo  !
=>oo" $
xoo% &
.oo& '
id_roloo' -
,oo- .
principalTablepp &
:pp& '
$strpp( /
,pp/ 0
principalColumnqq '
:qq' (
$strqq) 0
,qq0 1
onDeleterr  
:rr  !
ReferentialActionrr" 3
.rr3 4
Cascaderr4 ;
)rr; <
;rr< =
}ss 
)ss 
;ss 
migrationBuilderuu 
.uu 
CreateTableuu (
(uu( )
namevv 
:vv 
$strvv  
,vv  !
columnsww 
:ww 
tableww 
=>ww !
newww" %
{xx 

id_reservayy 
=yy  
tableyy! &
.yy& '
Columnyy' -
<yy- .
intyy. 1
>yy1 2
(yy2 3
typeyy3 7
:yy7 8
$stryy9 >
,yy> ?
nullableyy@ H
:yyH I
falseyyJ O
)yyO P
.zz 

Annotationzz #
(zz# $
$strzz$ 8
,zz8 9
$strzz: @
)zz@ A
,zzA B
	ClienteID{{ 
={{ 
table{{  %
.{{% &
Column{{& ,
<{{, -
int{{- 0
>{{0 1
({{1 2
type{{2 6
:{{6 7
$str{{8 =
,{{= >
nullable{{? G
:{{G H
false{{I N
){{N O
,{{O P
CampoID|| 
=|| 
table|| #
.||# $
Column||$ *
<||* +
int||+ .
>||. /
(||/ 0
type||0 4
:||4 5
$str||6 ;
,||; <
nullable||= E
:||E F
false||G L
)||L M
,||M N
fechaReserva}}  
=}}! "
table}}# (
.}}( )
Column}}) /
<}}/ 0
DateTime}}0 8
>}}8 9
(}}9 :
type}}: >
:}}> ?
$str}}@ F
,}}F G
nullable}}H P
:}}P Q
false}}R W
)}}W X
,}}X Y
horaReserva~~ 
=~~  !
table~~" '
.~~' (
Column~~( .
<~~. /
TimeSpan~~/ 7
>~~7 8
(~~8 9
type~~9 =
:~~= >
$str~~? E
,~~E F
nullable~~G O
:~~O P
false~~Q V
)~~V W
,~~W X
numeroHoras 
=  !
table" '
.' (
Column( .
<. /
int/ 2
>2 3
(3 4
type4 8
:8 9
$str: ?
,? @
nullableA I
:I J
falseK P
)P Q
,Q R
total
ÄÄ 
=
ÄÄ 
table
ÄÄ !
.
ÄÄ! "
Column
ÄÄ" (
<
ÄÄ( )
decimal
ÄÄ) 0
>
ÄÄ0 1
(
ÄÄ1 2
type
ÄÄ2 6
:
ÄÄ6 7
$str
ÄÄ8 G
,
ÄÄG H
nullable
ÄÄI Q
:
ÄÄQ R
false
ÄÄS X
)
ÄÄX Y
,
ÄÄY Z
estado
ÅÅ 
=
ÅÅ 
table
ÅÅ "
.
ÅÅ" #
Column
ÅÅ# )
<
ÅÅ) *
string
ÅÅ* 0
>
ÅÅ0 1
(
ÅÅ1 2
type
ÅÅ2 6
:
ÅÅ6 7
$str
ÅÅ8 G
,
ÅÅG H
nullable
ÅÅI Q
:
ÅÅQ R
true
ÅÅS W
)
ÅÅW X
}
ÇÇ 
,
ÇÇ 
constraints
ÉÉ 
:
ÉÉ 
table
ÉÉ "
=>
ÉÉ# %
{
ÑÑ 
table
ÖÖ 
.
ÖÖ 

PrimaryKey
ÖÖ $
(
ÖÖ$ %
$str
ÖÖ% 2
,
ÖÖ2 3
x
ÖÖ4 5
=>
ÖÖ6 8
x
ÖÖ9 :
.
ÖÖ: ;

id_reserva
ÖÖ; E
)
ÖÖE F
;
ÖÖF G
table
ÜÜ 
.
ÜÜ 

ForeignKey
ÜÜ $
(
ÜÜ$ %
name
áá 
:
áá 
$str
áá ;
,
áá; <
column
àà 
:
àà 
x
àà  !
=>
àà" $
x
àà% &
.
àà& '
CampoID
àà' .
,
àà. /
principalTable
ââ &
:
ââ& '
$str
ââ( 1
,
ââ1 2
principalColumn
ää '
:
ää' (
$str
ää) 4
,
ää4 5
onDelete
ãã  
:
ãã  !
ReferentialAction
ãã" 3
.
ãã3 4
Cascade
ãã4 ;
)
ãã; <
;
ãã< =
table
åå 
.
åå 

ForeignKey
åå $
(
åå$ %
name
çç 
:
çç 
$str
çç >
,
çç> ?
column
éé 
:
éé 
x
éé  !
=>
éé" $
x
éé% &
.
éé& '
	ClienteID
éé' 0
,
éé0 1
principalTable
èè &
:
èè& '
$str
èè( 2
,
èè2 3
principalColumn
êê '
:
êê' (
$str
êê) 5
,
êê5 6
onDelete
ëë  
:
ëë  !
ReferentialAction
ëë" 3
.
ëë3 4
Cascade
ëë4 ;
)
ëë; <
;
ëë< =
}
íí 
)
íí 
;
íí 
migrationBuilder
îî 
.
îî 
CreateTable
îî (
(
îî( )
name
ïï 
:
ïï 
$str
ïï $
,
ïï$ %
columns
ññ 
:
ññ 
table
ññ 
=>
ññ !
new
ññ" %
{
óó 
User_EmpresaID
òò "
=
òò# $
table
òò% *
.
òò* +
Column
òò+ 1
<
òò1 2
int
òò2 5
>
òò5 6
(
òò6 7
type
òò7 ;
:
òò; <
$str
òò= B
,
òòB C
nullable
òòD L
:
òòL M
false
òòN S
)
òòS T
.
ôô 

Annotation
ôô #
(
ôô# $
$str
ôô$ 8
,
ôô8 9
$str
ôô: @
)
ôô@ A
,
ôôA B

id_usuario
öö 
=
öö  
table
öö! &
.
öö& '
Column
öö' -
<
öö- .
int
öö. 1
>
öö1 2
(
öö2 3
type
öö3 7
:
öö7 8
$str
öö9 >
,
öö> ?
nullable
öö@ H
:
ööH I
false
ööJ O
)
ööO P
,
ööP Q

id_empresa
õõ 
=
õõ  
table
õõ! &
.
õõ& '
Column
õõ' -
<
õõ- .
int
õõ. 1
>
õõ1 2
(
õõ2 3
type
õõ3 7
:
õõ7 8
$str
õõ9 >
,
õõ> ?
nullable
õõ@ H
:
õõH I
false
õõJ O
)
õõO P
}
úú 
,
úú 
constraints
ùù 
:
ùù 
table
ùù "
=>
ùù# %
{
ûû 
table
üü 
.
üü 

PrimaryKey
üü $
(
üü$ %
$str
üü% 6
,
üü6 7
x
üü8 9
=>
üü: <
x
üü= >
.
üü> ?
User_EmpresaID
üü? M
)
üüM N
;
üüN O
table
†† 
.
†† 

ForeignKey
†† $
(
††$ %
name
°° 
:
°° 
$str
°° C
,
°°C D
column
¢¢ 
:
¢¢ 
x
¢¢  !
=>
¢¢" $
x
¢¢% &
.
¢¢& '

id_empresa
¢¢' 1
,
¢¢1 2
principalTable
££ &
:
££& '
$str
££( 2
,
££2 3
principalColumn
§§ '
:
§§' (
$str
§§) 5
,
§§5 6
onDelete
••  
:
••  !
ReferentialAction
••" 3
.
••3 4
Cascade
••4 ;
)
••; <
;
••< =
table
¶¶ 
.
¶¶ 

ForeignKey
¶¶ $
(
¶¶$ %
name
ßß 
:
ßß 
$str
ßß C
,
ßßC D
column
®® 
:
®® 
x
®®  !
=>
®®" $
x
®®% &
.
®®& '

id_usuario
®®' 1
,
®®1 2
principalTable
©© &
:
©©& '
$str
©©( 2
,
©©2 3
principalColumn
™™ '
:
™™' (
$str
™™) 5
,
™™5 6
onDelete
´´  
:
´´  !
ReferentialAction
´´" 3
.
´´3 4
Cascade
´´4 ;
)
´´; <
;
´´< =
}
¨¨ 
)
¨¨ 
;
¨¨ 
migrationBuilder
ÆÆ 
.
ÆÆ 
CreateIndex
ÆÆ (
(
ÆÆ( )
name
ØØ 
:
ØØ 
$str
ØØ -
,
ØØ- .
table
∞∞ 
:
∞∞ 
$str
∞∞  
,
∞∞  !
column
±± 
:
±± 
$str
±± $
)
±±$ %
;
±±% &
migrationBuilder
≥≥ 
.
≥≥ 
CreateIndex
≥≥ (
(
≥≥( )
name
¥¥ 
:
¥¥ 
$str
¥¥ +
,
¥¥+ ,
table
µµ 
:
µµ 
$str
µµ 
,
µµ 
column
∂∂ 
:
∂∂ 
$str
∂∂ $
)
∂∂$ %
;
∂∂% &
migrationBuilder
∏∏ 
.
∏∏ 
CreateIndex
∏∏ (
(
∏∏( )
name
ππ 
:
ππ 
$str
ππ +
,
ππ+ ,
table
∫∫ 
:
∫∫ 
$str
∫∫ !
,
∫∫! "
column
ªª 
:
ªª 
$str
ªª !
)
ªª! "
;
ªª" #
migrationBuilder
ΩΩ 
.
ΩΩ 
CreateIndex
ΩΩ (
(
ΩΩ( )
name
ææ 
:
ææ 
$str
ææ -
,
ææ- .
table
øø 
:
øø 
$str
øø !
,
øø! "
column
¿¿ 
:
¿¿ 
$str
¿¿ #
)
¿¿# $
;
¿¿$ %
migrationBuilder
¬¬ 
.
¬¬ 
CreateIndex
¬¬ (
(
¬¬( )
name
√√ 
:
√√ 
$str
√√ 2
,
√√2 3
table
ƒƒ 
:
ƒƒ 
$str
ƒƒ %
,
ƒƒ% &
column
≈≈ 
:
≈≈ 
$str
≈≈ $
)
≈≈$ %
;
≈≈% &
migrationBuilder
«« 
.
«« 
CreateIndex
«« (
(
««( )
name
»» 
:
»» 
$str
»» 2
,
»»2 3
table
…… 
:
…… 
$str
…… %
,
……% &
column
   
:
   
$str
   $
)
  $ %
;
  % &
migrationBuilder
ÃÃ 
.
ÃÃ 
CreateIndex
ÃÃ (
(
ÃÃ( )
name
ÕÕ 
:
ÕÕ 
$str
ÕÕ *
,
ÕÕ* +
table
ŒŒ 
:
ŒŒ 
$str
ŒŒ !
,
ŒŒ! "
column
œœ 
:
œœ 
$str
œœ  
)
œœ  !
;
œœ! "
}
–– 	
	protected
”” 
override
”” 
void
”” 
Down
””  $
(
””$ %
MigrationBuilder
””% 5
migrationBuilder
””6 F
)
””F G
{
‘‘ 	
migrationBuilder
’’ 
.
’’ 
	DropTable
’’ &
(
’’& '
name
÷÷ 
:
÷÷ 
$str
÷÷ 
)
÷÷ 
;
÷÷ 
migrationBuilder
ÿÿ 
.
ÿÿ 
	DropTable
ÿÿ &
(
ÿÿ& '
name
ŸŸ 
:
ŸŸ 
$str
ŸŸ  
)
ŸŸ  !
;
ŸŸ! "
migrationBuilder
€€ 
.
€€ 
	DropTable
€€ &
(
€€& '
name
‹‹ 
:
‹‹ 
$str
‹‹ $
)
‹‹$ %
;
‹‹% &
migrationBuilder
ﬁﬁ 
.
ﬁﬁ 
	DropTable
ﬁﬁ &
(
ﬁﬁ& '
name
ﬂﬂ 
:
ﬂﬂ 
$str
ﬂﬂ 
)
ﬂﬂ  
;
ﬂﬂ  !
migrationBuilder
·· 
.
·· 
	DropTable
·· &
(
··& '
name
‚‚ 
:
‚‚ 
$str
‚‚  
)
‚‚  !
;
‚‚! "
migrationBuilder
‰‰ 
.
‰‰ 
	DropTable
‰‰ &
(
‰‰& '
name
ÂÂ 
:
ÂÂ 
$str
ÂÂ  
)
ÂÂ  !
;
ÂÂ! "
migrationBuilder
ÁÁ 
.
ÁÁ 
	DropTable
ÁÁ &
(
ÁÁ& '
name
ËË 
:
ËË 
$str
ËË 
)
ËË 
;
ËË 
}
ÈÈ 	
}
ÍÍ 
}ÎÎ ≈
ÄC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Migrations\20231121072511_ReservasV5.1.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $

Migrations$ .
{ 
public 

partial 
class 
ReservasV51 $
:% &
	Migration' 0
{		 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
} 	
} 
} ±
ÄC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Migrations\20231121081234_ReservasV5.3.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $

Migrations$ .
{ 
public 

partial 
class 
ReservasV53 $
:% &
	Migration' 0
{		 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
AlterColumn (
<( )
string) /
>/ 0
(0 1
name 
: 
$str #
,# $
table 
: 
$str 
, 
type 
: 
$str $
,$ %
	maxLength 
: 
$num 
, 
nullable 
: 
false 
,  

oldClrType 
: 
typeof "
(" #
string# )
)) *
,* +
oldType 
: 
$str &
,& '
oldMaxLength 
: 
$num 
)  
;  !
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
AlterColumn (
<( )
string) /
>/ 0
(0 1
name 
: 
$str #
,# $
table 
: 
$str 
, 
type 
: 
$str #
,# $
	maxLength 
: 
$num 
, 
nullable   
:   
false   
,    

oldClrType!! 
:!! 
typeof!! "
(!!" #
string!!# )
)!!) *
,!!* +
oldType"" 
:"" 
$str"" '
,""' (
oldMaxLength## 
:## 
$num##  
)##  !
;##! "
}$$ 	
}%% 
}&& ’
hC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Models\Canchas.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $
Models$ *
{ 
public 

class 
Canchas 
{ 
[ 	
Key	 
] 
public		 
int		 
	id_cancha		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
[ 	

ForeignKey	 
( 
$str 
) 
] 
[ 	
Required	 
( 
ErrorMessage 
=  
$str! F
)F G
]G H
public 
int 

id_empresa 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
	MaxLength	 
( 
$num 
) 
] 
[ 	
Required	 
( 
ErrorMessage 
=  
$str! F
)F G
]G H
public 
string 
? 
deporte 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
	MaxLength	 
( 
$num 
) 
] 
public 
string 
? 
detalle 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
( 
ErrorMessage 
=  
$str! :
): ;
]; <
[ 	
Range	 
( 
$num 
, 
double 
. 
MaxValue !
,! "
ErrorMessage# /
=0 1
$str2 S
)S T
]T U
public 
decimal 
costoDia 
{  !
get" %
;% &
set' *
;* +
}, -
[ 	
Required	 
( 
ErrorMessage 
=  
$str! >
)> ?
]? @
[ 	
Range	 
( 
$num 
, 
double 
. 
MaxValue !
,! "
ErrorMessage# /
=0 1
$str2 S
)S T
]T U
public 
decimal 

costoNoche !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 
UrlImage 
{  !
get" %
;% &
set' *
;* +
}, -
public   
Empresas   
?   
Empresa    
{  ! "
get  # &
;  & '
set  ( +
;  + ,
}  - .
public"" 
ICollection"" 
<"" 
Reservas"" #
>""# $
?""$ %
Add_Reserva""& 1
{""2 3
get""4 7
;""7 8
set""9 <
;""< =
}""> ?
}## 
}$$ –#
iC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Models\Empresas.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $
Models$ *
{ 
public 

class 
Empresas 
{ 
[ 	
Key	 
] 
public		 
int		 

id_empresa		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
[ 	
Required	 
( 
ErrorMessage 
=  
$str! F
)F G
]G H
[ 	
StringLength	 
( 
$num 
) 
] 
public 
string 
? 
nombre 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
Required	 
] 
[ 	
StringLength	 
( 
$num 
) 
] 
public 
string 
? 
correo 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
Required	 
] 
[ 	
StringLength	 
( 
$num 
) 
] 
public 
string 
? 
celular 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
] 
[ 	
Column	 
( 
TypeName 
= 
$str !
)! "
]" #
public 
TimeSpan 
horaApertura $
{% &
get' *
;* +
set, /
;/ 0
}1 2
[ 	
Required	 
] 
[ 	
Column	 
( 
TypeName 
= 
$str !
)! "
]" #
public 
TimeSpan 

horaCierre "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
ICollection 
< 
Canchas "
>" #
?# $

Add_Cancha% /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
public!! 
ICollection!! 
<!! 
User_Empresa!! '
>!!' (
?!!( )
Add_EmpresaUsuario!!* <
{!!= >
get!!? B
;!!B C
set!!D G
;!!G H
}!!I J
public## 
ICollection## 
<## 

MediosPago## %
>##% &
?##& '
Add_MedioPago##( 5
{##6 7
get##8 ;
;##; <
set##= @
;##@ A
}##B C
[%% 	
	NotMapped%%	 
]%% 
public&& 
TimeSpan&& 
DiferenciaHoras&& '
{'' 	
get(( 
{)) 
if** 
(** 
horaApertura**  
>**! "

horaCierre**# -
)**- .
{++ 
var,, 
	horaNueva,, !
=,," #

horaCierre,,$ .
.,,. /
Add,,/ 2
(,,2 3
new,,3 6
TimeSpan,,7 ?
(,,? @
$num,,@ B
,,,B C
$num,,D E
,,,E F
$num,,G H
),,H I
),,I J
;,,J K
return-- 
	horaNueva-- $
---% &
horaApertura--' 3
;--3 4
}.. 
return00 

horaCierre00 !
-00" #
horaApertura00$ 0
;000 1
}11 
}22 	
public44 
IEnumerable44 
<44 
TimeSpan44 #
>44# $(
ObtenerRangoHorasDisponibles44% A
(44A B
)44B C
{55 	
return66 

Enumerable66 
.66 
Range66 #
(66# $
horaApertura66$ 0
.660 1
Hours661 6
,666 7
DiferenciaHoras668 G
.66G H
Hours66H M
+66N O
$num66P Q
)66Q R
.77 
Select77 $
(77$ %
h77% &
=>77' )
TimeSpan77* 2
.772 3
	FromHours773 <
(77< =
h77= >
)77> ?
)77? @
;77@ A
}88 	
}99 
}:: ı
oC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Models\ErrorViewModel.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $
Models$ *
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
? 
	RequestId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
ShowRequestId !
=>" $
!% &
string& ,
., -
IsNullOrEmpty- :
(: ;
	RequestId; D
)D E
;E F
} 
}		 Ú
kC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Models\MediosPago.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $
Models$ *
{ 
public 

class 

MediosPago 
{ 
[ 	
Key	 
] 
public		 
int		 
id_pagos		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
[ 	

ForeignKey	 
( 
$str 
) 
]  
public 
int 

id_empresa 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
Required	 
( 
ErrorMessage 
=  
$str! D
)D E
]E F
[ 	
	MaxLength	 
( 
$num 
) 
] 
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
Required	 
( 
ErrorMessage 
=  
$str! H
)H I
]I J
[ 	
	MaxLength	 
( 
$num 
) 
] 
public 
string 
Descripcion !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
Empresas 
? 
Empresas !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} ˆ
iC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Models\Reservas.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $
Models$ *
{ 
public 

class 
Reservas 
{ 
[ 	
Key	 
] 
public		 
int		 

id_reserva		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
[ 	
Required	 
] 
public 
int 
	ClienteID 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	

ForeignKey	 
( 
$str 
) 
] 
[ 	
Required	 
( 
ErrorMessage 
=  
$str! 2
)2 3
]3 4
public 
int 
CampoID 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
Required	 
] 
[ 	
Column	 
( 
TypeName 
= 
$str !
)! "
]" #
public 
DateTime 
fechaReserva $
{% &
get' *
;* +
set, /
;/ 0
}1 2
[ 	
Required	 
] 
[ 	
Column	 
( 
TypeName 
= 
$str !
)! "
]" #
public 
TimeSpan 
horaReserva #
{$ %
get& )
;) *
set+ .
;. /
}0 1
[ 	
Required	 
( 
ErrorMessage 
=  
$str  A
)A B
]B C
[ 	
Range	 
( 
$num 
, 
$num 
, 
ErrorMessage "
=# $
$str% T
)T U
]U V
public 
int 
numeroHoras 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
] 
public 
decimal 
total 
{ 
get "
;" #
set$ '
;' (
}) *
public!! 
string!! 
?!! 
estado!! 
{!! 
get!!  #
;!!# $
set!!% (
;!!( )
}!!* +
public## 
Canchas## 
?## 
Campo## 
{## 
get##  #
;### $
set##% (
;##( )
}##* +
public%% 
Usuarios%% 
?%% 
Cliente%%  
{%%! "
get%%# &
;%%& '
set%%( +
;%%+ ,
}%%- .
public'' 
decimal'' 
ObtenerCostoHora'' '
(''' (
TimeSpan''( 0
	horaCampo''1 :
,'': ;
Canchas''< C
canchas''D K
)''K L
{(( 	
decimal)) 
costoDia)) 
=)) 
canchas)) &
.))& '
costoDia))' /
;))/ 0
decimal** 

costoNoche** 
=**  
canchas**! (
.**( )

costoNoche**) 3
;**3 4
var-- 
tiempo-- 
=-- 
	horaCampo-- "
.--" #
Hours--# (
>=--) +
$num--, -
&&--. 0
	horaCampo--1 :
.--: ;
Hours--; @
<--A B
$num--C E
;--E F
return00 
tiempo00 
?00 
costoDia00 $
:00% &

costoNoche00' 1
;001 2
}11 	
}22 
}33 “
dC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Models\Rol.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $
Models$ *
{ 
public 

class 
Rol 
{ 
public 
int 
RolID 
{ 
get 
; 
set  #
;# $
}% &
[		 	
	MaxLength			 
(		 
$num		 
)		 
]		 
public

 
string

 
Descripcion

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
public 
ICollection 
< 
Usuarios #
># $
?$ %
Add_Usuario& 1
{2 3
get4 7
;7 8
set9 <
;< =
}> ?
} 
} ¢(
iC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Models\SeedData.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $
Models$ *
{ 
public 

class 
SeedData 
{		 
public

 
static

 
void

 

Initialize

 %
(

% &
IServiceProvider

& 6
serviceProvider

7 F
)

F G
{ 	
using 
( 
var 
db 
= 
new 
AppDbContext  ,
(, -
serviceProvider 
.  
GetRequiredService  2
<2 3
DbContextOptions $
<$ %
AppDbContext% 1
>1 2
>2 3
(3 4
)4 5
)5 6
)6 7
{ 
if 
( 
db 
. 
Roles 
. 
Any  
(  !
)! "
)" #
{ 
return 
; 
} 
db 
. 
Roles 
. 
AddRange !
(! "
new 
Rol 
{ 
Descripcion )
=* +
$str, 8
}9 :
,: ;
new 
Rol 
{ 
Descripcion )
=* +
$str, ;
}< =
,= >
new 
Rol 
{ 
Descripcion )
=* +
$str, 5
}6 7
) 
; 
db 
. 
SaveChanges 
( 
)  
;  !
} 
} 	
public   
static   
void   
AddSupervisor   (
(  ( )
IServiceProvider  ) 9
serviceProvider  : I
)  I J
{!! 	
using"" 
("" 
var"" 
context"" 
=""  
new""! $
AppDbContext""% 1
(""1 2
serviceProvider## 
.##  
GetRequiredService##  2
<##2 3
DbContextOptions$$ $
<$$$ %
AppDbContext$$% 1
>$$1 2
>$$2 3
($$3 4
)$$4 5
)$$5 6
)$$6 7
{%% 
if'' 
('' 
context'' 
.'' 
Usuarios'' $
.''$ %
Any''% (
(''( )
)'') *
)''* +
{(( 
return)) 
;)) 
}** 
context,, 
.,, 
Usuarios,,  
.,,  !
AddRange,,! )
(,,) *
new-- 
Usuarios--  
{.. 
id_rol// 
=//  
$num//! "
,//" #
usuario00 
=00  !
$str00" -
,00- .
pass22 
=22 
	Encriptar22 (
(22( )
$str22) 4
)224 5
,225 6
nombres33 
=33  !
$str33" 4
,334 5
	apellidos44 !
=44" #
$str44$ 7
,447 8
tipoDocumento55 %
=55& '
$str55( -
,55- .
	documento66 !
=66" #
$str66$ .
,66. /
correo77 
=77  
$str77! 5
,775 6
celular88 
=88  !
$str88" -
,88- .
estado99 
=99  
true99! %
}:: 
);; 
;;; 
context== 
.== 
SaveChanges== #
(==# $
)==$ %
;==% &
}>> 
}?? 	
public@@ 
static@@ 
string@@ 
	Encriptar@@ &
(@@& '
string@@' -
texto@@. 3
)@@3 4
{AA 	
StringBuilderBB 
sbBB 
=BB 
newBB "
StringBuilderBB# 0
(BB0 1
)BB1 2
;BB2 3
usingCC 
(CC 
SHA256CC 
hashCC 
=CC  
SHA256CC! '
.CC' (
CreateCC( .
(CC. /
)CC/ 0
)CC0 1
{DD 
EncodingEE 
encEE 
=EE 
EncodingEE '
.EE' (
UTF8EE( ,
;EE, -
byteFF 
[FF 
]FF 
resultFF 
=FF 
hashFF  $
.FF$ %
ComputeHashFF% 0
(FF0 1
encFF1 4
.FF4 5
GetBytesFF5 =
(FF= >
textoFF> C
)FFC D
)FFD E
;FFE F
foreachGG 
(GG 
byteGG 
bGG 
inGG  "
resultGG# )
)GG) *
{HH 
sbII 
.II 
AppendII 
(II 
bII 
.II  
ToStringII  (
(II( )
$strII) -
)II- .
)II. /
;II/ 0
}JJ 
}KK 
returnLL 
sbLL 
.LL 
ToStringLL 
(LL 
)LL  
;LL  !
}MM 	
}NN 
}OO ˆ
mC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Models\User_Empresa.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $
Models$ *
{ 
public 

class 
User_Empresa 
{ 
public 
int 
User_EmpresaID !
{" #
get$ '
;' (
set) ,
;, -
}. /
[

 	

ForeignKey

	 
(

 
$str

 
)

 
]

 
[ 	
Required	 
( 
ErrorMessage 
=  
$str! =
)= >
]> ?
public 
int 

id_usuario 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	

ForeignKey	 
( 
$str 
) 
] 
[ 	
Required	 
( 
ErrorMessage 
=  
$str! =
)= >
]> ?
public 
int 

id_empresa 
{ 
get  #
;# $
set% (
;( )
}* +
public 
Usuarios 
? 
Usuario  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
Empresas 
? 
Empresa  
{! "
get# &
;& '
set( +
;+ ,
}- .
} 
} è(
iC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Models\Usuarios.cs
	namespace 	"
WebCamposDeportivos_V1
  
.  !
_2! #
.# $
Models$ *
{ 
public 

class 
Usuarios 
{ 
[		 	
Key			 
]		 
public

 
int

 

id_usuario

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
[ 	

ForeignKey	 
( 
$str 
) 
] 
[ 	
Required	 
] 
public 
int 
id_rol 
{ 
get 
;  
set! $
;$ %
}& '
[ 	
Required	 
( 
ErrorMessage 
=  
$str! L
)L M
]M N
[ 	
StringLength	 
( 
$num 
, 
ErrorMessage &
=' (
$str) O
)O P
]P Q
public 
string 
usuario 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
Required	 
( 
ErrorMessage 
=  
$str! F
)F G
]G H
[ 	
	MinLength	 
( 
$num 
, 
ErrorMessage "
=# $
$str% Y
)Y Z
]Z [
public 
string 
pass 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
Required	 
( 
ErrorMessage 
=  
$str! A
)A B
]B C
[ 	
StringLength	 
( 
$num 
, 
ErrorMessage &
=' (
$str) O
)O P
]P Q
public 
string 
nombres 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
Required	 
( 
ErrorMessage 
=  
$str! A
)A B
]B C
[ 	
StringLength	 
( 
$num 
, 
ErrorMessage &
=' (
$str) O
)O P
]P Q
public 
string 
	apellidos 
{  !
get" %
;% &
set' *
;* +
}, -
[   	
Required  	 
(   
ErrorMessage   
=    
$str  ! L
)  L M
]  M N
[!! 	
StringLength!!	 
(!! 
$num!! 
)!! 
]!! 
public"" 
string"" 
tipoDocumento"" #
{""$ %
get""& )
;"") *
set""+ .
;"". /
}""0 1
[$$ 	
Required$$	 
($$ 
ErrorMessage$$ 
=$$  
$str$$! G
)$$G H
]$$H I
[%% 	
	MaxLength%%	 
(%% 
$num%% 
)%% 
]%% 
public&& 
string&& 
	documento&& 
{&&  !
get&&" %
;&&% &
set&&' *
;&&* +
}&&, -
[(( 	
Required((	 
((( 
ErrorMessage(( 
=((  
$str((! H
)((H I
]((I J
[)) 	
StringLength))	 
()) 
$num)) 
))) 
])) 
public** 
string** 
correo** 
{** 
get** "
;**" #
set**$ '
;**' (
}**) *
[,, 	
Required,,	 
(,, 
ErrorMessage,, 
=,,  
$str,,! C
),,C D
],,D E
[-- 	
	MaxLength--	 
(-- 
$num-- 
)-- 
]-- 
public.. 
string.. 
celular.. 
{.. 
get..  #
;..# $
set..% (
;..( )
}..* +
public00 
bool00 
estado00 
{00 
get00  
;00  !
set00" %
;00% &
}00' (
public22 
Rol22 
?22 
Rol22 
{22 
get22 
;22 
set22 "
;22" #
}22$ %
public33 
ICollection33 
<33 
Reservas33 #
>33# $
?33$ %
Add_Reserva33& 1
{332 3
get334 7
;337 8
set339 <
;33< =
}33> ?
public44 
ICollection44 
<44 
User_Empresa44 '
>44' (
?44( )
Add_EmpresaUsuario44* <
{44= >
get44? B
;44B C
set44D G
;44G H
}44I J
}55 
}66 ö
aC:\Users\UCLAB505\Desktop\ReservasCamposDeportivos-nuevo (V5)\WebCamposDeportivos_V1.2\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder

 
.

 
Services

 
.

 #
AddControllersWithViews

 (
(

( )
)

) *
;

* +
builder 
. 
Services 
. 
AddDbContext 
< 
AppDbContext *
>* +
(+ ,
options, 3
=>4 6
options7 >
.> ?
UseSqlServer? K
(K L
builder0 7
.7 8
Configuration8 E
.E F
GetConnectionStringF Y
(Y Z
$strZ i
)i j
)j k
)k l
;l m
builder 
. 
Services 
. #
AddControllersWithViews (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddAuthentication "
(" #(
CookieAuthenticationDefaults# ?
.? @ 
AuthenticationScheme@ T
)T U
. 
	AddCookie 
( 
option 
=> 
{ 
option 
. 
	LoginPath 
= 
$str *
;* +
option 
. 
AccessDeniedPath 
=  !
$str" /
;/ 0
} 
) 
; 
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
using 
( 
var 

scope 
= 
app 
. 
Services 
.  
CreateScope  +
(+ ,
), -
)- .
{   
var!! 
services!! 
=!! 
scope!! 
.!! 
ServiceProvider!! (
;!!( )
SeedData"" 
."" 

Initialize"" 
("" 
services""  
)""  !
;""! "
var$$ 
	services2$$ 
=$$ 
scope$$ 
.$$ 
ServiceProvider$$ )
;$$) *
SeedData%% 
.%% 
AddSupervisor%% 
(%% 
	services2%% $
)%%$ %
;%%% &
}&& 
if)) 
()) 
!)) 
app)) 
.)) 	
Environment))	 
.)) 
IsDevelopment)) "
())" #
)))# $
)))$ %
{** 
app++ 
.++ 
UseExceptionHandler++ 
(++ 
$str++ +
)+++ ,
;++, -
app-- 
.-- 
UseHsts-- 
(-- 
)-- 
;-- 
}.. 
app00 
.00 
UseHttpsRedirection00 
(00 
)00 
;00 
app11 
.11 
UseStaticFiles11 
(11 
)11 
;11 
app33 
.33 

UseRouting33 
(33 
)33 
;33 
app55 
.55 
UseAuthentication55 
(55 
)55 
;55 
app77 
.77 
UseAuthorization77 
(77 
)77 
;77 
app;; 
.;; 
MapControllerRoute;; 
(;; 
name<< 
:<< 	
$str<<
 
,<< 
pattern== 
:== 
$str== 9
)==9 :
;==: ;
app?? 
.?? 
Run?? 
(?? 
)?? 	
;??	 
